function Output(e,t){var a=jQuery(e).parents(".armFileUploadWrapper").find(".armFileMessages").attr("id");null!=a&&(document.getElementById(a).innerHTML=t)}function ParseFile(a,e){var t,r=jQuery(e),o=r.parents(".armFileUploadWrapper"),i=o.find(".armFileDragArea"),n=r.attr("data-file_type"),d=r.attr("data-avatar-type");t="cover"===d&&"profile"===d?["php","php3","php4","php5","pl","py","jsp","asp","exe","cgi","gif","GIF"]:["php","php3","php4","php5","pl","py","jsp","asp","exe","cgi"];var l=a.name.lastIndexOf("."),s=(s=a.name.substring(l+1)).toLowerCase(),c=r.attr("data-msg-invalid");if(null==c&&(c=invalidFileTypeError),-1<t.indexOf(s))return Output(e,"<div class='arm_error_msg' style='opacity: 1;'><div class='arm_error_box_arrow'></div>"+c+"</div>"),r.val(""),r.attr("value",""),r.trigger("change"),!1;var p,m,u=r.attr("accept");if(null!=u&&(p=u.replace(/\./g,"").split(","),-1==jQuery.inArray(s,p)))return Output(e,"<div class='arm_error_msg' style='opacity: 1;'><div class='arm_error_box_arrow'></div>"+c+"</div>"),r.val(""),r.attr("value",""),r.trigger("change"),!1;window.FileReader?"badges"==n||"social_icon"==n?o.find(".arm_old_file").html(""):(0==a.type.indexOf("image")?(m=new FileReader).onload=function(e){var t='<div class="arm_uploaded_file_info" id="arm_uploaded_file_info" style="position:relative;">';t+='<img src="'+e.target.result+'"/>',t+="</div>",t+='<div class="armFileRemoveContainer">x</div>',o.find(".arm_old_file").html(t)}:(m=new FileReader).onload=function(e){var t='<div class="arm_uploaded_file_info">';t+='<img src="'+__ARMIMAGEURL+'/file_icon.png"/>',t+='<span class="arm_uploaded_file_name">'+a.name+"</span>",t+="</div>",t+='<div class="armFileRemoveContainer">x</div>',o.find(".arm_old_file").html(t)},m.readAsDataURL(a)):o.find(".arm_old_file").html(""),i.find(".armbar").css("width","0%").show(),i.find(".armFileDragAreaText").hide()}function UploadFile(e,s){var c=!0;jQuery(".arm_stripe_icon_error").html("");var p=jQuery(s);if(void 0!==p.attr("data-arm_clicked")&&"done"==p.attr("data-arm_clicked"))return!1;void 0!==p.attr("data-arm_clicked")&&"not"==p.attr("data-arm_clicked")&&p.attr("data-arm_clicked","done");var t,m=p.attr("data-avatar-type"),u=p.attr("data-update-meta"),h=(p.attr("class"),p.parents(".armFileUploadWrapper")),f=h.find(".armFileBtn"),g=h.find(".armFileUploadContainer"),_=h.find(".armFileDragArea"),v=h.find(".armFileRemoveContainer"),y=h.find(".armFileUploadProgressBar"),b=h.find(".armFileUploadProgressInfo"),a=p.attr("data-file_size"),w=p.attr("data-file_type"),r=1024*a*1024;t="cover"===m&&"profile"===m?["php","php3","php4","php5","pl","py","jsp","asp","exe","cgi","gif","GIF"]:["php","php3","php4","php5","pl","py","jsp","asp","exe","cgi"];var j=new XMLHttpRequest,o=e.name.lastIndexOf("."),i=(i=e.name.substring(o+1)).toLowerCase(),n=p.attr("data-msg-invalid");null==n&&(n=invalidFileTypeError);var d,l,C,x,Q,M,R,A=p.attr("accept");if(null!=A&&(d=A.replace(/\./g,"").split(","),-1===jQuery.inArray(i,d)))return"badges"!=w&&"social_icon"!=w||(Output(s,"<span class='arm_error_msg error' style='opacity: 1;'>"+n+"</span>"),p.trigger("change")),!1;if(e.size>r){var L=n;return L=(L=L.replace("{SIZE}",a+"MB")).replace("{size}",a+"MB"),setTimeout(function(){h.find(".arm_old_file").html(""),_.find(".armFileDragAreaText").show()},200),Output(s,"<div class='arm_error_msg' style='opacity: 1;'><div class='arm_error_box_arrow'></div>"+L+"</div>"),p.val(""),p.attr("value",""),p.trigger("change"),!1}return-1===jQuery.inArray(i,t)&&(j.upload?(l=RandomString(5),C=e.name.lastIndexOf("."),x=e.name.substring(C+1),Q=/.*(?=\.)/.exec(e.name),M=("badges"==w?(jQuery(".arm_button_manage_badges").attr("disabled","disabled"),"arm_badges_"+l+"_"+Q):"social_icon"==w?"arm_icon_"+l+"_"+Q:"armFile"+l+"_"+Q).replace(/[^\w\s]/gi,"").replace(/ /g,"")+"."+x,y.show(),y.find(".armbar").css("width","0%"),_.find(".armbar").css("width","0%").show(),h.find(".armFileMessages").html(""),b.html(""),j.upload.addEventListener("progress",function(e){var t=parseFloat(0+e.loaded/e.total*100),t=Math.round(t);h.find(".armbar").css("width",t+"%"),y.find(".armbar").css("width",t+"%"),b.show(),b.html('<span class="armFileName" style="float:left">'+M+'</span><span style="float:right">'+t+"%</span>")},!1),j.addEventListener("load",function(e){},!1),R=new FormData,"badges"==w?(j.open("POST",__ARMAJAXURL,!0),R.append("action","arm_upload_badge")):"social_icon"==w?(j.open("POST",__ARMAJAXURL,!0),R.append("action","arm_upload_social_icon")):(j.open("POST",__ARMAJAXURL),R.append("action","arm_upload_front"),"arm_stripe_popup_icon_input"==jQuery(s).attr("id")&&R.append("arm_file_type","arm_stripe_icon")),j.setRequestHeader("X_FILENAME",M),j.setRequestHeader("X-FILENAME",M),R.append("armfileselect",e),j.send(R),c=!1,j.onreadystatechange=function(e){if(4==j.readyState&&200==j.status){var t,a,r,o,l,i=j.responseText;if(-1!=i.indexOf("error")){var n=jQuery.parseJSON(i);return p.attr("data-arm_clicked","not"),jQuery(".arm_stripe_icon_error").html(n.message),!(c=!0)}-1==i.indexOf("http://")&&-1==i.indexOf("https://")||(i="//"+i.split("://")[1]),"armTempEditFileUploadBG_add"==p.attr("id")||"armTempEditFileUploadBG_edit"==p.attr("id")?(jQuery(".arm_card_background_file_url").val(i),jQuery(".arm_card_background_wrapper").addClass("hidden_section"),jQuery(".arm_card_background_remove").removeClass("hidden_section"),jQuery(".arm_card_bg_selected_img img").attr("src",i).css("display","inline-block")):(jQuery(".arm_card_logo_file_url").val(i),jQuery(".arm_card_logo_wrapper").addClass("hidden_section"),jQuery(".arm_card_logo_remove").removeClass("hidden_section"),jQuery(".arm_card_selecred_img img").attr("src",i).css("display","inline-block")),"arm_stripe_popup_icon_input"==p.attr("id")&&(jQuery(".arm_stripe_popup_icon_file_url").val(i),jQuery(".arm_stripe_popup_icon_wrapper").addClass("hidden_section"),jQuery(".arm_stripe_popup_icon_remove").removeClass("hidden_section"),jQuery(".arm_stripe_popup_icon_selected_img").removeClass("hidden_section"),jQuery(".arm_stripe_popup_icon_selected_img img").attr("src",i).css("display","inline-block")),h.find("input.arm_file_url").attr("data-icon",M),h.find("input.arm_file_url").val(i).trigger("change"),h.find(".armUploadedFileName").val(M),h.find(".arm_image_file_preview").html('<img alt="Uploaded File" src="'+i+'"/>'),g.hide(),f.hide(),v.show(),_.find(".armFileDragAreaText").hide(),"cover"===m?770<jQuery(window).width()?0!=jQuery("#arm_crop_cover_div").length?(jQuery("#arm_crop_cover_div").find("img").attr("src",""),jQuery("#arm_crop_cover_div").find("img").attr("src",i),t=jQuery("#arm_crop_cover_image"),a=0,l=new Cropper(t,{viewMode:4,aspectRatio:2.86875,dragCrop:!0,zoomable:!0,rotatable:!0,dashed:!1,cropBoxResizable:!1,dragMode:"move",zoomOnTouch:!1,crop:function(e){jQuery("#arm_crop_cover_image").attr("data-coord",Math.round(e.detail.x)+","+Math.round(e.detail.y)+","+Math.round(e.detail.width)+","+Math.round(e.detail.height)),0==a&&(jQuery(".arm_clear_cover_button.arm_img_cover_setting").trigger("click"),jQuery("#arm_crop_cover_image").attr("data-coord","0,0,0,0"),a=1)},background:!1}),jQuery(".arm_img_cover_setting").on("click",function(e){var t,a,r,o,i=e||window.event,n=i.target||i.srcElement,d=4;if(l){for(;n!==this&&!n.getAttribute("data-method");)n=n.parentNode;if(o={method:n.getAttribute("data-method"),target:n.getAttribute("data-target"),option:n.getAttribute("data-option")||void 0,secondOption:n.getAttribute("data-second-option")||void 0},t=l.cropped,o.method){if(void 0!==o.target&&(r=document.querySelector(o.target),!n.hasAttribute("data-option")&&o.target&&r))try{o.option=JSON.parse(r.value)}catch(i){console.log(i.message)}switch(o.method){case"reset":case"rotate":t&&0<d&&l.clear();break;case"getCroppedCanvas":try{o.option=JSON.parse(o.option)}catch(i){console.log(i.message)}"image/jpeg"===uploadedImageType&&(o.option||(o.option={}),o.option.fillColor="#fff")}switch(a=l[o.method](o.option,o.secondOption),o.method){case"rotate":t&&0<d&&l.crop();break;case"scaleX":case"scaleY":n.setAttribute("data-option",-o.option);break;case"getCroppedCanvas":a&&(jQuery("#getCroppedCanvasModal").modal().find(".modal-body").html(a),download.disabled||(download.download=uploadedImageName,download.href=a.toDataURL(uploadedImageType)));break;case"destroy":l=null,uploadedImageURL&&(URL.revokeObjectURL(uploadedImageURL),uploadedImageURL="",image.src=originalImageURL)}if("object"==typeof a&&a!==l&&r)try{r.value=JSON.stringify(a)}catch(i){console.log(i.message)}}}}),jQuery("#arm_crop_cover_div_wrapper").bPopup({opacity:.5,closeClass:"arm_popup_close_btn",follow:[!1,!1],escClose:!1,modalClose:!1,zIndex:9999999,onClose:function(){g.show(),f.show(),y.hide(),y.find(".armbar").css("width","0%"),b.html(""),h.find("input").val(""),h.find("input.arm_file_url").attr("data-icon",""),p.val(""),p.attr("value",""),p.trigger("change"),h.find(".armFileMessages").html(""),h.find(".arm_image_file_preview").html(""),h.find(".arm_old_file").html(""),h.find(".arm_old_uploaded_file").html(""),v.hide(),_.find(".armFileDragAreaText").show(),_.find(".armbar").css("width","0%").hide();var e=h.attr("data-iframe");jQuery("#"+e+"_iframe_div").html(" ").append('<iframe id="'+e+'_iframe" src="'+__ARMVIEWURL+'/iframeupload.php"></iframe>'),l.destroy()}}),document.getElementById("arm_skip_cvr_crop_nav_admn").onclick=function(){var e=jQuery("#arm_crop_cover_image").attr("src"),t=jQuery("#arm_crop_cover_image").attr("data-rotate"),a=jQuery("#arm_crop_cover_image").attr("data-coord");jQuery(this).attr("disabled","disabled"),jQuery.ajax({type:"POST",url:__ARMAJAXURL,data:"action=arm_crop_iamge&type=cover&src="+e+"&update_meta="+u+"&cord="+a+"&rotate="+t,success:function(t){jQuery("<img />").attr("src",t+"?"+Math.floor(100*Math.random()+1)).on("load",function(){p.parents(".arm_form_input_wrapper").find(".arm_uploaded_file_info img").attr("src",i+"?"+Math.floor(100*Math.random()+1)),jQuery(".arm_profile_picture_block").css("background-image","url("+t+"?"+Math.floor(100*Math.random())+")");var e=p.attr("id");jQuery(".arm_default_cover_photo_wrapper").hide(),jQuery(".arm_remove_default_cover_photo_wrapper").show(),jQuery("#"+e+"_hidden").val(t)});jQuery("#arm_crop_cover_div_wrapper").bPopup().close(),l.destroy(),jQuery("#arm_crop_cover_image").attr("data-rotate",0),jQuery("#arm_skip_cvr_crop_nav_admn").removeAttr("disabled")}})}):jQuery.ajax({type:"POST",url:__ARMAJAXURL,data:"action=arm_crop_iamge&type=cover&src="+i+"&update_meta="+u,success:function(t){jQuery("<img />").attr("src",t+"?"+Math.floor(100*Math.random()+1)).on("load",function(){p.parents(".arm_form_input_wrapper").find(".arm_uploaded_file_info img").attr("src",i+"?"+Math.floor(100*Math.random()+1)),jQuery(".arm_profile_picture_block").css("background-image","url("+t+"?"+Math.floor(100*Math.random())+")");var e=p.attr("id");jQuery(".arm_default_cover_photo_wrapper").hide(),jQuery(".arm_remove_default_cover_photo_wrapper").show(),jQuery("#"+e+"_hidden").val(t)})}}):(jQuery("#arm_crop_cover_div").find("img").attr("src",""),jQuery("<img />").attr("src",i+"?"+Math.floor(100*Math.random()+1)).on("load",function(){jQuery("#arm_crop_cover_div").append(jQuery(this))}),p.parents(".arm_form_input_wrapper").find(".arm_uploaded_file_info img").attr("src",i+"?"+Math.floor(100*Math.random()+1))):"profile"===m?(jQuery("#arm_crop_div").find("img").attr("src",""),jQuery("#arm_crop_div").find("img").attr("src",i),r=jQuery("#arm_crop_image"),o=0,l=new Cropper(r,{viewMode:4,aspectRatio:1,dragCrop:!1,zoomable:!0,rotatable:!0,dashed:!1,cropBoxResizable:!1,dragMode:"move",zoomOnTouch:!1,crop:function(e){jQuery("#arm_crop_image").attr("data-coord",Math.round(e.detail.x)+","+Math.round(e.detail.y)+","+Math.round(e.detail.width)+","+Math.round(e.detail.height)),0==o&&(jQuery(".arm_clear_button.arm_img_setting").trigger("click"),jQuery("#arm_crop_image").attr("data-coord","0,0,0,0"),o=1)},background:!1}),jQuery(".arm_img_setting").on("click",function(e){var t,a,r,o,i=e||window.event,n=i.target||i.srcElement,d=4;if(l){for(;n!==this&&!n.getAttribute("data-method");)n=n.parentNode;if(o={method:n.getAttribute("data-method"),target:n.getAttribute("data-target"),option:n.getAttribute("data-option")||void 0,secondOption:n.getAttribute("data-second-option")||void 0},t=l.cropped,o.method){if(void 0!==o.target&&(r=document.querySelector(o.target),!n.hasAttribute("data-option")&&o.target&&r))try{o.option=JSON.parse(r.value)}catch(i){console.log(i.message)}switch(o.method){case"reset":case"rotate":t&&0<d&&l.clear();break;case"getCroppedCanvas":try{o.option=JSON.parse(o.option)}catch(i){console.log(i.message)}"image/jpeg"===uploadedImageType&&(o.option||(o.option={}),o.option.fillColor="#fff")}switch(a=l[o.method](o.option,o.secondOption),o.method){case"rotate":t&&0<d&&l.crop();break;case"scaleX":case"scaleY":n.setAttribute("data-option",-o.option);break;case"getCroppedCanvas":a&&(jQuery("#getCroppedCanvasModal").modal().find(".modal-body").html(a),download.disabled||(download.download=uploadedImageName,download.href=a.toDataURL(uploadedImageType)));break;case"destroy":l=null,uploadedImageURL&&(URL.revokeObjectURL(uploadedImageURL),uploadedImageURL="",image.src=originalImageURL)}if("object"==typeof a&&a!==l&&r)try{r.value=JSON.stringify(a)}catch(i){console.log(i.message)}}}}),jQuery("#arm_crop_div_wrapper").bPopup({opacity:.5,closeClass:"arm_popup_close_btn",follow:[!1,!1],escClose:!1,modalClose:!1,zIndex:9999999,onClose:function(){g.show(),f.show(),y.hide(),y.find(".armbar").css("width","0%"),b.html(""),h.find("input").val(""),h.find("input.arm_file_url").attr("data-icon",""),p.val(""),p.attr("value",""),p.trigger("change"),h.find(".armFileMessages").html(""),h.find(".arm_image_file_preview").html(""),h.find(".arm_old_file").html(""),h.find(".arm_old_uploaded_file").html(""),v.hide(),_.find(".armFileDragAreaText").show(),_.find(".armbar").css("width","0%").hide();var e=h.attr("data-iframe");jQuery("#"+e+"_iframe_div").html(" ").append('<iframe id="'+e+'_iframe" src="'+__ARMVIEWURL+'/iframeupload.php"></iframe>'),l.destroy()}}),document.getElementById("arm_skip_avtr_crop_nav_admn").onclick=function(){var e=jQuery("#arm_crop_image").attr("src"),t=jQuery("#arm_crop_image").attr("data-rotate"),a=jQuery("#arm_crop_image").attr("data-coord");jQuery(this).attr("disabled","disabled"),jQuery.ajax({type:"POST",url:__ARMAJAXURL,data:"action=arm_crop_iamge&type=profile&src="+e+"&update_meta="+u+"&rotate="+t+"&cord="+a,success:function(e){jQuery("<img />").attr("src",e+"?"+Math.floor(100*Math.random()+1)).on("load",function(){p.parents(".arm_form_input_wrapper").find(".arm_uploaded_file_info img").attr("src",e+"?"+Math.floor(100*Math.random()+1))});jQuery("#arm_crop_div_wrapper").bPopup().close(),l.destroy(),jQuery("#arm_crop_image").attr("data-rotate",0),jQuery("#arm_skip_avtr_crop_nav_admn").removeAttr("disabled")}})}):"badges"==w&&(jQuery(".arm_button_manage_badges").removeAttr("disabled"),jQuery("#arm_badges_icon-error").remove()),c=!1}else{var d;200!=j.status&&(d=""!=j.responseText&&401==j.status?j.responseText:fileUploadError,Output(s,"<div class='arm_error_msg' style='opacity: 1;'><div class='arm_error_box_arrow'></div>"+d+"</div>"),p.val(""),p.attr("value",""),p.trigger("change"),g.show(),f.show(),y.hide(),y.find(".armbar").css("width","0%"),b.html(""),h.find("input").val(""),h.find("input.arm_file_url").attr("data-icon",""),h.find(".arm_old_file").html(""),h.find(".arm_old_uploaded_file").html(""),v.hide(),_.find(".armFileDragAreaText").show(),_.find(".armbar").css("width","0%").hide())}}):Output(s,"<div class='arm_error_msg' style='opacity: 1;'><div class='arm_error_box_arrow'></div>"+fileUploadError+"</div>")),c&&(p.val(""),p.attr("value",""),p.trigger("change"),g.show(),f.show(),y.hide(),y.find(".armbar").css("width","0%"),b.html(""),h.find("input").val(""),h.find(".arm_old_file").html(""),h.find(".arm_old_uploaded_file").html(""),v.hide(),_.find(".armFileDragAreaText").show(),_.find(".armbar").css("width","0%").hide()),!1}function FileSelectHandlerDrag(e){FileDragHover(e);var t=jQuery(e.target).attr("data-id"),a=jQuery("#"+t),r=e.target.files||e.dataTransfer.files;if(1<r.length)return invalid_msg=fileUploadErrorMultiple,Output(a,"<div class='arm_error_msg' style='opacity: 1;'><div class='arm_error_box_arrow'></div>"+invalid_msg+"</div>"),!1;"null"!=r&&void 0!==r&&jQuery.each(r,function(e,t){ParseFile(t,a),UploadFile(t,a)})}function Init(){(new XMLHttpRequest).upload&&jQuery(".armFileUploaderWrapper").each(function(e,t){var a,r=jQuery(this).attr("id");""!=r&&null!=r&&((a=document.getElementById(r)).addEventListener("dragover",FileDragHover,!1),a.addEventListener("dragleave",FileDragHover,!1),a.addEventListener("drop",FileSelectHandlerDrag,!1),a.style.display="block")})}function FileDragHover(e){e.stopPropagation(),e.preventDefault();var t=e.target;"dragover"==e.type?jQuery(t).parents(".armFileDragArea").addClass("arm_dragover"):jQuery(t).parents(".armFileDragArea").removeClass("arm_dragover")}function FileSelectHandler(e){FileDragHover(e);var a=e.target,t="";if(null!=typeof(t="armTempEditFileUploadBG_add"==jQuery(a).attr("id")||"armTempEditFileUploadBG_edit"==jQuery(a).attr("id")?jQuery(a).attr("data-arm_mcard_bg_img"):"arm_stripe_poupp_icon_input"==jQuery(a).attr("id")?jQuery(a).attr("data-arm_stripe_popup_icon"):jQuery(a).attr("data-arm_mcard_logo"))||""!=t){var r=jQuery(a).val().split(".").pop().toLowerCase();if(-1==jQuery.inArray(r,["png","jpg","jpeg","bmp"]))return"undefined"!=typeof ARM_MCARD_LOGO_ERROR_MSG?alert(ARM_MCARD_LOGO_ERROR_MSG):alert("Invalid File"),!1}var o="";if(1<(o=void 0===a.files?a&&a.value?[{name:a.value.replace(/^.+\\/,"")}]:[]:a.files).length)return invalid_msg=fileUploadErrorMultiple,Output(a,"<div class='arm_error_msg' style='opacity: 1;'><div class='arm_error_box_arrow'></div>"+invalid_msg+"</div>"),!1;"null"!=o&&void 0!==o&&jQuery.each(o,function(e,t){ParseFile(t,a),UploadFile(t,a)})}function initArmFileUpload(){jQuery(".armFileUpload:not(.armIEFileUpload), .armFileUploadBG:not(.armIEFileUpload), .arm_stripe_popup_icon:not(.armIEFileUpload)").each(function(e,t){var a=jQuery(this).attr("id");""!=a&&null!=a&&document.getElementById(a).addEventListener("change",FileSelectHandler,!1)})}function arm_remove_cover(){var e=jQuery("#armRemoveCover").parents(".arm_template_container"),t=jQuery("#armRemoveCover").attr("data-cover"),a=jQuery("#armRemoveCover").attr("data-default-cover");""!=t&&(e.css("opacity","0.5"),jQuery.ajax({type:"POST",url:__ARMAJAXURL,data:"action=arm_remove_uploaded_file&file_name="+t+"&type=profile_cover",success:function(){a=jQuery("#armRemoveCover").attr("data-default-cover"),e.css("opacity","1"),jQuery(".arm_profile_picture_block").css("background-image","url("+a+"?"+Math.floor(100*Math.random())+")"),jQuery("#armRemoveCover").hide(),jQuery(".arm_delete_cover_popup").removeClass("armopen").slideUp()}}))}function arm_remove_profile(){var e=jQuery("#armRemoveProfilePic").attr("data-cover"),r=jQuery("#armRemoveProfilePic").parents(".arm_user_avatar").find("img");""!=e&&(r.css("opacity","0.5"),jQuery.ajax({type:"POST",url:__ARMAJAXURL,data:"action=arm_remove_uploaded_file&file_name="+e+"&type=profile_pic",success:function(e){jQuery(".arm_delete_profile_popup").removeClass("armopen").slideUp(),r.attr("src",e),jQuery(".arm_profile_detail_tbl").find(".arm_user_avatar").find("img").attr("src",e);var t=e.split("/"),a=t[Object.keys(t).length-1];return jQuery("#armRemoveProfilePic").attr("data-cover",a),r.parent().find("#armRemoveProfilePic").attr("data-cover",a),r.parent().find("#armRemoveProfilePic").hide(),jQuery("#armRemoveProfilePic").parent().hide(),jQuery("#armRemoveProfilePic").parent().addClass("arm_no_profile"),jQuery("#armRemoveProfilePic").hide(),!1}}))}function hideConfirmBoxCallbackprofile(){jQuery(".arm_delete_profile_popup").removeClass("armopen").slideUp()}function RandomString(e){for(var t=null!=e&&0!=e?e:5,a="",r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",o=0;o<t;o++)a+=r.charAt(Math.floor(Math.random()*r.length));return a}jQuery(document).ready(function(e){window.File&&window.FileList&&window.FileReader&&Init(),initArmFileUpload(),jQuery(document).on("click",".armIEFileUpload",function(e){var p=jQuery(this),m=p.attr("data-iframe"),t=jQuery("#"+m+"_iframe");t.contents().find("#armfileselect").click();var a=t.contents().find("#armfileselect").val();if(""!=a&&void 0!==a){var u=p.parents(".armFileUploadWrapper"),h=u.find(".armFileBtn"),f=u.find(".armFileUploadContainer"),g=u.find(".armFileRemoveContainer"),_=u.find(".armFileUploadProgressBar"),v=u.find(".armFileUploadProgressInfo"),y=p.attr("data-file_size"),r=p.attr("data-file_type"),b=p.attr("data-avatar-type"),o=1024*y*1024;null==p.attr("data-msg-invalid")&&invalidFileTypeError;var i,n=a.replace(/C:\\fakepath\\/i,""),d=function(e){for(var t=null!=e&&0!=e?e:5,a="",r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",o=0;o<t;o++)a+=r.charAt(Math.floor(Math.random()*r.length));return a}(6),l=n.lastIndexOf("."),s=n.substring(l+1),c=/.*(?=\.)/.exec(n),w=("badges"==r?"arm_badges_"+d+"_"+c:"social_icon"==r?"arm_icon_"+d+"_"+c:"armFile"+d+"_"+c).replace(/[^\w\s]/gi,"").replace(/ /g,"")+"."+s,j=s.toLowerCase(),C=p.attr("accept");if(null!=C&&(i=C.replace(/\./g,"").split(","),-1===jQuery.inArray(j,i)))return p.val(w),p.attr("value",w),p.trigger("change"),!1;if(-1===jQuery.inArray(j,["php","php3","php4","php5","pl","py","jsp","asp","exe","cgi"])){"badges"==r?t.contents().find("form").attr("action",__ARMAJAXURL+"?action=arm_upload_badge&fname="+w+"&allow_size="+o):"social_icon"==r?t.contents().find("form").attr("action",__ARMAJAXURL+"?action=arm_upload_social_icon&fname="+w+"&allow_size="+o):t.contents().find("form").attr("action",__ARMAJAXURL+"?action=arm_upload_front&fname="+w+"&allow_size="+o),t.contents().find("form").submit(),u.find(".armUploadedFileName").val(w),f.hide(),h.hide(),u.find(".armFileMessages").html(""),_.show(),_.find(".armbar").css("width","0%"),v.html(""),_.find(".armbar").animate({width:"100%"},"slow"),v.html('<span class="armFileName" style="float:left">'+w+'</span><span style="float:right">100%</span>'),g.show();var x=setInterval(function(){var e,t,a,r,o,i,l,n=jQuery("#"+m+"_iframe").contents().find(".uploaded").length;p.val(w),p.attr("value",w),0<n&&(clearInterval(x),e=jQuery("#"+m+"_iframe").contents().find(".uploaded").html(),u.find(".armUploadedFileName").val(w),u.find("input.arm_file_url").attr("data-icon",w),u.find("input.arm_file_url").val(e),jQuery("#"+m+"_iframe_div").html(" ").append('<iframe id="'+m+'_iframe" src="'+__ARMVIEWURL+'/iframeupload.php"></iframe>'),p.trigger("change"),"profile"==b?(-1==e.indexOf("http://")&&-1==e.indexOf("https://")||(r="//"+e.split("://")[1]),770<jQuery(window).width()&&(jQuery("#arm_crop_div").find("img").attr("src",r),t=jQuery("#arm_crop_image"),a=0,l=new Cropper(t,{viewMode:4,aspectRatio:1,dragCrop:!1,zoomable:!0,rotatable:!0,dashed:!1,cropBoxResizable:!1,dragMode:"move",zoomOnTouch:!1,crop:function(e){jQuery("#arm_crop_image").attr("data-coord",Math.round(e.detail.x)+","+Math.round(e.detail.y)+","+Math.round(e.detail.width)+","+Math.round(e.detail.height)),0==a&&(jQuery(".arm_clear_button.arm_img_setting").trigger("click"),jQuery("#arm_crop_image").attr("data-coord","0,0,0,0"),a=1)},background:!1}),jQuery(".arm_img_setting").on("click",function(e){var t,a,r,o,i=e||window.event,n=i.target||i.srcElement,d=4;if(l){for(;n!==this&&!n.getAttribute("data-method");)n=n.parentNode;if(o={method:n.getAttribute("data-method"),target:n.getAttribute("data-target"),option:n.getAttribute("data-option")||void 0,secondOption:n.getAttribute("data-second-option")||void 0},t=l.cropped,o.method){if(void 0!==o.target&&(r=document.querySelector(o.target),!n.hasAttribute("data-option")&&o.target&&r))try{o.option=JSON.parse(r.value)}catch(i){console.log(i.message)}switch(o.method){case"reset":case"rotate":t&&0<d&&l.clear();break;case"getCroppedCanvas":try{o.option=JSON.parse(o.option)}catch(i){console.log(i.message)}"image/jpeg"===uploadedImageType&&(o.option||(o.option={}),o.option.fillColor="#fff")}switch(a=l[o.method](o.option,o.secondOption),o.method){case"rotate":t&&0<d&&l.crop();break;case"scaleX":case"scaleY":n.setAttribute("data-option",-o.option);break;case"getCroppedCanvas":a&&(jQuery("#getCroppedCanvasModal").modal().find(".modal-body").html(a),download.disabled||(download.download=uploadedImageName,download.href=a.toDataURL(uploadedImageType)));break;case"destroy":l=null,uploadedImageURL&&(URL.revokeObjectURL(uploadedImageURL),uploadedImageURL="",image.src=originalImageURL)}if("object"==typeof a&&a!==l&&r)try{r.value=JSON.stringify(a)}catch(i){console.log(i.message)}}}}),jQuery("#arm_crop_div_wrapper").bPopup({opacity:.5,closeClass:"arm_popup_close_btn",follow:[!1,!1],escClose:!1,modalClose:!1,zIndex:9999999,onClose:function(){l.destroy()}}),document.getElementsByClassName("arm_crop_button")[0].onclick=function(){var e=jQuery("#arm_crop_image").attr("data-coord"),t=jQuery("#arm_crop_image").attr("src"),a=jQuery("#arm_crop_image").attr("data-rotate");jQuery.ajax({type:"POST",url:__ARMAJAXURL,data:"action=arm_crop_iamge&type=profile&src="+t+"&cord="+e+"&rotate="+a,success:function(e){jQuery("#arm_crop_div_wrapper").bPopup().close(),l.destroy(),jQuery("#arm_crop_image").attr("data-rotate",0)}})})):"cover"==b&&(-1==e.indexOf("http://")&&-1==e.indexOf("https://")||(r="//"+e.split("://")[1]),770<jQuery(window).width()&&(jQuery("#arm_crop_cover_div").find("img").attr("src",r),jQuery("#arm_crop_cover_div_wrapper").bPopup({opacity:.5,closeClass:"arm_popup_close_btn",follow:[!0,!0],escClose:!1,modalClose:!1,zIndex:9999999,onClose:function(){l.destroy()}}),o=jQuery("#arm_crop_cover_image"),i=0,l=new Cropper(o,{viewMode:4,aspectRatio:2.86875,zoomable:!0,rotatable:!0,dashed:!1,dragMode:"move",cropBoxResizable:!1,background:!1,zoomOnTouch:!1,crop:function(e){jQuery("#arm_crop_cover_image").attr("data-coord",Math.round(e.detail.x)+","+Math.round(e.detail.y)+","+Math.round(e.detail.width)+","+Math.round(e.detail.height)),0==i&&(jQuery(".arm_clear_cover_button.arm_img_cover_setting").trigger("click"),jQuery("#arm_crop_cover_image").attr("data-coord","0,0,0,0"),i=1)}}),jQuery(".arm_img_cover_setting").on("click",function(e){var t,a,r,o,i=e||window.event,n=i.target||i.srcElement,d=4;if(l){for(;n!==this&&!n.getAttribute("data-method");)n=n.parentNode;if(o={method:n.getAttribute("data-method"),target:n.getAttribute("data-target"),option:n.getAttribute("data-option")||void 0,secondOption:n.getAttribute("data-second-option")||void 0},t=l.cropped,o.method){if(void 0!==o.target&&(r=document.querySelector(o.target),!n.hasAttribute("data-option")&&o.target&&r))try{o.option=JSON.parse(r.value)}catch(i){console.log(i.message)}switch(o.method){case"reset":case"rotate":t&&0<d&&l.clear();break;case"getCroppedCanvas":try{o.option=JSON.parse(o.option)}catch(i){console.log(i.message)}"image/jpeg"===uploadedImageType&&(o.option||(o.option={}),o.option.fillColor="#fff")}switch(a=l[o.method](o.option,o.secondOption),o.method){case"rotate":t&&0<d&&l.crop();break;case"scaleX":case"scaleY":n.setAttribute("data-option",-o.option);break;case"getCroppedCanvas":a&&(jQuery("#getCroppedCanvasModal").modal().find(".modal-body").html(a),download.disabled||(download.download=uploadedImageName,download.href=a.toDataURL(uploadedImageType)));break;case"destroy":l=null,uploadedImageURL&&(URL.revokeObjectURL(uploadedImageURL),uploadedImageURL="",image.src=originalImageURL)}if("object"==typeof a&&a!==l&&r)try{r.value=JSON.stringify(a)}catch(i){console.log(i.message)}}}}),document.getElementsByClassName("arm_crop_cover_button")[0].onclick=function(){var e=jQuery("#arm_crop_cover_image").attr("data-coord"),t=jQuery("#arm_crop_cover_image").attr("src"),a=jQuery("#arm_crop_cover_image").attr("data-rotate");jQuery.ajax({type:"POST",url:__ARMAJAXURL,data:"action=arm_crop_iamge&type=cover&src="+t+"&cord="+e+"&rotate="+a,success:function(e){jQuery("<img />").attr("src",e+"?"+Math.floor(100*Math.random()+1)).on("load",function(){jQuery(".arm_profile_picture_block").css("background-image","url("+e+"?"+Math.floor(100*Math.random())+")")});jQuery("#arm_crop_cover_div_wrapper").bPopup().close(),jQuery("#armRemoveCover").show(),jQuery("#arm_crop_cover_image").attr("src",""),l.destroy(),jQuery("#arm_crop_cover_image").attr("data-rotate",0),0}})})));var d,s=jQuery("#"+m+"_iframe").contents().find(".error_upload").length,c=jQuery("#"+m+"_iframe").contents().find(".error_upload_size").length;(0<s||0<c)&&(clearInterval(x),0<s&&Output(p,"<div class='arm_error_msg' style='opacity: 1;'><div class='arm_error_box_arrow'></div>"+fileUploadError+"</div>"),0<c&&(d=(d=d.replace("{SIZE}",y+"MB")).replace("{size}",y+"MB"),Output(p,"<div class='arm_error_msg' style='opacity: 1;'><div class='arm_error_box_arrow'></div>"+d+"</div>")),p.val(""),p.attr("value",""),p.trigger("change"),f.show(),h.show(),_.hide(),_.find(".armbar").css("width","0%"),v.html(""),u.find("input").val(""),u.find(".arm_old_file").html(""),u.find(".arm_old_uploaded_file").html(""),g.hide(),jQuery("#"+m+"_iframe_div").html(" ").append('<iframe id="'+m+'_iframe" src="'+__ARMVIEWURL+'/iframeupload.php"></iframe>'))},500);return!1}}}),jQuery(document).on("click",".armFileRemoveContainer",function(e){var a=jQuery(this).parents(".armFileUploadWrapper"),r=a.find(".armFileBtn"),o=a.find(".armFileUpload"),i=a.find(".armFileUploadContainer"),n=a.find(".armFileDragArea"),d=a.find(".armFileRemoveContainer"),l=a.find(".armFileUploadProgressBar"),s=a.find(".armFileUploadProgressInfo"),t=s.find(".armFileName").text(),c=a.find(".arm_file_url").val(),p=a.find(".arm_file_url").attr("data-file_type");if("badges"===p||"directory_cover"===p)return jQuery(".armFileRemoveContainer").hide(),jQuery(".arm_old_file").hide(),jQuery(".armFileUploadProgressInfo").hide(),jQuery(".armFileUploadProgressBar").hide(),jQuery(".armFileUploadContainer").show(),jQuery("#arm_badges_icon").val(""),"directory_cover"===p&&(jQuery(".arm_default_cover_image_url").val(""),a.find(".arm_old_file").html(""),a.find(".arm_old_uploaded_file").html(""),a.find(".armFileUploadProgressInfo span").html(""),jQuery(".armFileUploadProgressInfo").show()),!1;jQuery.ajax({type:"POST",url:__ARMAJAXURL,data:"action=arm_remove_uploaded_file&file_name="+t+"&file_url="+c+"&type="+p,success:function(e){i.show(),r.show(),l.hide(),l.find(".armbar").css("width","0%"),s.html(""),a.find("input").val(""),a.find("input.arm_file_url").attr("data-icon",""),o.val(""),o.attr("value",""),o.trigger("change"),a.find(".armFileMessages").html(""),a.find(".arm_image_file_preview").html(""),a.find(".arm_old_file").html(""),a.find(".arm_old_uploaded_file").html(""),d.hide(),n.find(".armFileDragAreaText").show(),n.find(".armbar").css("width","0%").hide();var t=a.attr("data-iframe");jQuery("#"+t+"_iframe_div").html(" ").append('<iframe id="'+t+'_iframe" src="'+__ARMVIEWURL+'/iframeupload.php"></iframe>')}})});jQuery(".arm_rotate_button").on("click",function(){var e=jQuery("#arm_crop_image").attr("data-rotate"),e=parseFloat(e)+90;e%=360,jQuery("#arm_crop_image").attr("data-rotate",e)}),jQuery("#arm_crop_div_wrapper_close, .arm_reset_button").on("click",function(){jQuery("#arm_crop_image").attr("data-rotate",0)}),jQuery(".arm_rotate_cover_button").on("click",function(){var e=jQuery("#arm_crop_image").attr("data-rotate"),e=parseFloat(e)+90;e%=360,jQuery("#arm_crop_cover_image").attr("data-rotate",e)}),jQuery("#arm_crop_cover_div_wrapper_close, .arm_reset_cover_button").on("click",function(){jQuery("#arm_crop_cover_image").attr("data-rotate",0)})}),function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var a=t();for(var r in a)("object"==typeof exports?exports:e)[r]=a[r]}}(this,function(){return o={},a.m=r=[function(e,t,a){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=function(e,t,a){return t&&i(e.prototype,t),a&&i(e,a),e};function i(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var n=r(a(1)),p=r(a(2)),d=r(a(3)),l=r(a(5)),s=r(a(6)),c=r(a(7)),m=r(a(8)),u=r(a(9)),h=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t}(a(4)),f="cropper",g=f+"-hidden",_="error",v="load",y=/^data:/,b=void 0,w=(o(j,[{key:"init",value:function(){var e=this,t=e.element,a=t.tagName.toLowerCase(),r=void 0;if(!h.getData(t,f)){if(h.setData(t,f,e),"img"===a){if(e.isImg=!0,e.originalUrl=r=t.getAttribute("src"),!r)return;r=t.src}else"canvas"===a&&window.HTMLCanvasElement&&(r=t.toDataURL());e.load(r)}}},{key:"load",value:function(e){var t,a=this,r=a.options,o=a.element;e&&(a.url=e,a.imageData={},r.checkOrientation&&window.ArrayBuffer?y.test(e)?a.read(h.dataURLToArrayBuffer(e)):((t=new XMLHttpRequest).onerror=t.onabort=function(){a.clone()},t.onload=function(){a.read(t.response)},r.checkCrossOrigin&&h.isCrossOriginURL(e)&&o.crossOrigin&&(e=h.addTimestamp(e)),t.open("get",e),t.responseType="arraybuffer",t.send()):a.clone())}},{key:"read",value:function(e){var t=this.options,a=h.getOrientation(e),r=this.imageData,o=0,i=1,n=1;if(1<a)switch(this.url=h.arrayBufferToDataURL(e),a){case 2:i=-1;break;case 3:o=-180;break;case 4:n=-1;break;case 5:o=90,n=-1;break;case 6:o=90;break;case 7:o=90,i=-1;break;case 8:o=-90}t.rotatable&&(jQuery("#arm_crop_image").attr("data-rotate",o),jQuery("#arm_crop_cover_image").attr("data-rotate",o)),t.scalable&&(r.scaleX=i,r.scaleY=n),this.clone()}},{key:"clone",value:function(){var e,t,a=this,r=a.element,o=a.url,i=void 0,n=void 0;a.options.checkCrossOrigin&&h.isCrossOriginURL(o)&&(n=(i=r.crossOrigin)?o:(i="anonymous",h.addTimestamp(o))),a.crossOrigin=i,a.crossOriginUrl=n;var d=h.createElement("img");i&&(d.crossOrigin=i),d.src=n||o,a.image=d,a.onStart=e=h.proxy(a.start,a),a.onStop=t=h.proxy(a.stop,a),a.isImg?r.complete?a.start():h.addListener(r,v,e):(h.addListener(d,v,e),h.addListener(d,_,t),h.addClass(d,"cropper-hide"),r.parentNode.insertBefore(d,r.nextSibling))}},{key:"start",value:function(e){var a=this,t=a.isImg?a.element:a.image;e&&(h.removeListener(t,v,a.onStart),h.removeListener(t,_,a.onStop)),h.getImageSize(t,function(e,t){h.extend(a.imageData,{naturalWidth:e,naturalHeight:t,aspectRatio:e/t}),a.loaded=!0,a.build()})}},{key:"stop",value:function(){var e=this.image;h.removeListener(e,v,this.onStart),h.removeListener(e,_,this.onStop),h.removeChild(e),this.image=null}},{key:"build",value:function(){var e,t,a,r,o,i,n=this,d=n.options,l=n.element,s=n.image,c=void 0;n.loaded&&(n.ready&&n.unbuild(),(i=h.createElement("div")).innerHTML=p.default,n.container=c=l.parentNode,n.cropper=e=h.getByClass(i,"cropper-container")[0],n.canvas=t=h.getByClass(e,"cropper-canvas")[0],n.dragBox=a=h.getByClass(e,"cropper-drag-box")[0],n.cropBox=r=h.getByClass(e,"cropper-crop-box")[0],n.viewBox=h.getByClass(e,"cropper-view-box")[0],n.face=o=h.getByClass(r,"cropper-face")[0],h.appendChild(t,s),h.addClass(l,g),c.insertBefore(e,l.nextSibling),n.isImg||h.removeClass(s,"cropper-hide"),n.initPreview(),n.bind(),d.aspectRatio=Math.max(0,d.aspectRatio)||NaN,d.viewMode=Math.max(0,Math.min(3,Math.round(d.viewMode)))||0,d.autoCrop?(n.cropped=!0,d.modal&&h.addClass(a,"cropper-modal")):h.addClass(r,g),d.guides||h.addClass(h.getByClass(r,"cropper-dashed"),g),d.center||h.addClass(h.getByClass(r,"cropper-center"),g),d.background&&h.addClass(e,"cropper-bg"),d.highlight||h.addClass(o,"cropper-invisible"),d.cropBoxMovable&&(h.addClass(o,"cropper-move"),h.setData(o,"action","all")),d.cropBoxResizable||(h.addClass(h.getByClass(r,"cropper-line"),g),h.addClass(h.getByClass(r,"cropper-point"),g)),n.setDragMode(d.dragMode),n.render(),n.ready=!0,n.setData(d.data),setTimeout(function(){h.isFunction(d.ready)&&h.addListener(l,"ready",d.ready,!0),h.dispatchEvent(l,"ready"),h.dispatchEvent(l,"crop",n.getData()),n.complete=!0},0))}},{key:"unbuild",value:function(){var e=this;e.ready&&(e.ready=!1,e.complete=!1,e.initialImageData=null,e.initialCanvasData=null,e.initialCropBoxData=null,e.containerData=null,e.canvasData=null,e.cropBoxData=null,e.unbind(),e.resetPreview(),e.previews=null,e.viewBox=null,e.cropBox=null,e.dragBox=null,e.canvas=null,e.container=null,h.removeChild(e.cropper),e.cropper=null)}}],[{key:"noConflict",value:function(){return window.Cropper=b,j}},{key:"setDefaults",value:function(e){h.extend(n.default,h.isPlainObject(e)&&e)}}]),j);function j(e,t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,j);var a=this;a.element=e[0],a.options=h.extend({},n.default,h.isPlainObject(t)&&t),a.loaded=!1,a.ready=!1,a.complete=!1,a.rotated=!1,a.cropped=!1,a.disabled=!1,a.replaced=!1,a.limited=!1,a.wheeling=!1,a.isImg=!1,a.originalUrl="",a.canvasData=null,a.cropBoxData=null,a.previews=null,a.init()}h.extend(w.prototype,d.default),h.extend(w.prototype,l.default),h.extend(w.prototype,s.default),h.extend(w.prototype,c.default),h.extend(w.prototype,m.default),h.extend(w.prototype,u.default),"undefined"!=typeof window&&(b=window.Cropper,window.Cropper=w),t.default=w},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={viewMode:0,dragMode:"crop",aspectRatio:NaN,data:null,preview:"",responsive:!0,restore:!0,checkCrossOrigin:!0,checkOrientation:!0,modal:!0,guides:!0,center:!0,highlight:!0,background:!0,autoCrop:!0,autoCropArea:.8,movable:!0,rotatable:!0,scalable:!0,zoomable:!0,zoomOnTouch:!1,zoomOnWheel:!0,wheelZoomRatio:.1,cropBoxMovable:!0,cropBoxResizable:!0,toggleDragModeOnDblclick:!1,minCanvasWidth:0,minCanvasHeight:0,minCropBoxWidth:0,minCropBoxHeight:0,minContainerWidth:200,minContainerHeight:100,ready:null,cropstart:null,cropmove:null,cropend:null,crop:null,zoom:null}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default='<div class="cropper-container"><div class="cropper-wrap-box"><div class="cropper-canvas"></div></div><div class="cropper-drag-box"></div><div class="cropper-crop-box"><span class="cropper-view-box"></span><span class="cropper-dashed dashed-h"></span><span class="cropper-dashed dashed-v"></span><span class="cropper-center"></span><span class="cropper-face"></span><span class="cropper-line line-e" data-action="e"></span><span class="cropper-line line-n" data-action="n"></span><span class="cropper-line line-w" data-action="w"></span><span class="cropper-line line-s" data-action="s"></span><span class="cropper-point point-e" data-action="e"></span><span class="cropper-point point-n" data-action="n"></span><span class="cropper-point point-w" data-action="w"></span><span class="cropper-point point-s" data-action="s"></span><span class="cropper-point point-ne" data-action="ne"></span><span class="cropper-point point-nw" data-action="nw"></span><span class="cropper-point point-sw" data-action="sw"></span><span class="cropper-point point-se" data-action="se"></span></div></div>'},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t}(a(4));t.default={render:function(){var e=this;e.initContainer(),e.initCanvas(),e.initCropBox(),e.renderCanvas(),e.cropped&&e.renderCropBox()},initContainer:function(){var e,t=this,a=t.options,r=t.element,o=t.container,i=t.cropper;p.addClass(i,"cropper-hidden"),p.removeClass(r,"cropper-hidden"),t.containerData=e={width:Math.max(o.offsetWidth,Number(a.minContainerWidth)||200),height:Math.max(o.offsetHeight,Number(a.minContainerHeight)||100)},p.setStyle(i,{width:e.width,height:e.height}),p.addClass(r,"cropper-hidden"),p.removeClass(i,"cropper-hidden")},initCanvas:function(){var e=this,t=e.options.viewMode,a=e.containerData,r=e.imageData,o=90===Math.abs(r.rotate),i=o?r.naturalHeight:r.naturalWidth,n=o?r.naturalWidth:r.naturalHeight,d=i/n,l=a.width,s=a.height;a.height*d>a.width?3===t?l=a.height*d:s=a.width/d:3===t?s=a.width/d:l=a.height*d;var c={naturalWidth:i,naturalHeight:n,aspectRatio:d,width:l,height:s};c.oldLeft=c.left=(a.width-l)/2,c.oldTop=c.top=(a.height-s)/2,e.canvasData=c,e.limited=1===t||2===t,e.limitCanvas(!0,!0),e.initialImageData=p.extend({},r),e.initialCanvasData=p.extend({},c)},limitCanvas:function(e,t){var a=this,r=a.options,o=r.viewMode,i=a.containerData;null==i&&(i=[]);var n=a.canvasData;null==n&&(n=[]);var d,l,s=n.aspectRatio,c=a.cropBoxData,p=a.cropped&&c,m=void 0,u=void 0;e&&(m=Number(r.minCanvasWidth)||0,u=Number(r.minCanvasHeight)||0,1<o?(m=Math.max(m,i.width),u=Math.max(u,i.height),3===o&&(m<u*s?m=u*s:u=m/s)):0<o&&(m?m=Math.max(m,p?c.width:0):u?u=Math.max(u,p?c.height:0):p&&((m=c.width)<(u=c.height)*s?m=u*s:u=m/s)),m&&u?m<u*s?u=m/s:m=u*s:m?u=m/s:u&&(m=u*s),n.minWidth=m,n.minHeight=u,n.maxWidth=1/0,n.maxHeight=1/0),t&&(o?(d=i.width-n.width,l=i.height-n.height,n.minLeft=Math.min(0,d),n.minTop=Math.min(0,l),n.maxLeft=Math.max(0,d),n.maxTop=Math.max(0,l),p&&a.limited&&(n.minLeft=Math.min(c.left,c.left+(c.width-n.width)),n.minTop=Math.min(c.top,c.top+(c.height-n.height)),n.maxLeft=c.left,n.maxTop=c.top,2===o&&(n.width>=i.width&&(n.minLeft=Math.min(0,d),n.maxLeft=Math.max(0,d)),n.height>=i.height&&(n.minTop=Math.min(0,l),n.maxTop=Math.max(0,l))))):(n.minLeft=-n.width,n.minTop=-n.height,n.maxLeft=i.width,n.maxTop=i.height))},renderCanvas:function(e){var t=this,a=t.canvasData;null==a&&(a=[]);var r,o=t.imageData,i=o.rotate,n=void 0;t.rotated&&(t.rotated=!1,(r=(n=p.getRotatedSizes({width:o.width,height:o.height,degree:i})).width/n.height)!==a.aspectRatio&&(a.left-=(n.width-a.width)/2,a.top-=(n.height-a.height)/2,a.width=n.width,a.height=n.height,a.aspectRatio=r,a.naturalWidth=o.naturalWidth,a.naturalHeight=o.naturalHeight,i%180&&(n=p.getRotatedSizes({width:o.naturalWidth,height:o.naturalHeight,degree:i}),a.naturalWidth=n.width,a.naturalHeight=n.height),t.limitCanvas(!0,!1))),(a.width>a.maxWidth||a.width<a.minWidth)&&(a.left=a.oldLeft),(a.height>a.maxHeight||a.height<a.minHeight)&&(a.top=a.oldTop),a.width=Math.min(Math.max(a.width,a.minWidth),a.maxWidth),a.height=Math.min(Math.max(a.height,a.minHeight),a.maxHeight),t.limitCanvas(!1,!0),a.oldLeft=a.left=Math.min(Math.max(a.left,a.minLeft),a.maxLeft),a.oldTop=a.top=Math.min(Math.max(a.top,a.minTop),a.maxTop),p.setStyle(t.canvas,{width:a.width,height:a.height,left:a.left,top:a.top}),t.renderImage(),t.cropped&&t.limited&&t.limitCropBox(!0,!0),e&&t.output()},renderImage:function(e){var t=this.canvasData;null==t&&(t=[]);var a,r,o,i=this.imageData,n=void 0;i.rotate&&(n={width:r=(a=p.getRotatedSizes({width:t.width,height:t.height,degree:i.rotate,aspectRatio:i.aspectRatio},!0)).width,height:o=a.height,left:(t.width-r)/2,top:(t.height-o)/2}),p.extend(i,n||{width:t.width,height:t.height,left:0,top:0});var d=p.getTransform(i);p.setStyle(this.image,{width:i.width,height:i.height,marginLeft:i.left,marginTop:i.top,WebkitTransform:d,msTransform:d,transform:d}),e&&this.output()},initCropBox:function(){var e=this,t=e.options,a=t.aspectRatio,r=Number(t.autoCropArea)||.8,o=e.canvasData,i={width:o.width,height:o.height};a&&(o.height*a>o.width?i.height=i.width/a:i.width=i.height*a),e.cropBoxData=i,e.limitCropBox(!0,!0),i.width=Math.min(Math.max(i.width,i.minWidth),i.maxWidth),i.height=Math.min(Math.max(i.height,i.minHeight),i.maxHeight),i.width=Math.max(i.minWidth,i.width*r),i.height=Math.max(i.minHeight,i.height*r),i.oldLeft=i.left=o.left+(o.width-i.width)/2,i.oldTop=i.top=o.top+(o.height-i.height)/2,e.initialCropBoxData=p.extend({},i)},limitCropBox:function(e,t){var a=this,r=a.options,o=r.aspectRatio,i=a.containerData,n=a.canvasData,d=a.cropBoxData,l=a.limited,s=void 0,c=void 0,p=void 0,m=void 0;null==d&&(d=[]),null==i&&(i=[]),e&&(s=Number(r.minCropBoxWidth)||0,c=Number(r.minCropBoxHeight)||0,s=Math.min(s,i.width),c=Math.min(c,i.height),p=Math.min(i.width,l?n.width:i.width),m=Math.min(i.height,l?n.height:i.height),o&&(s&&c?s<c*o?c=s/o:s=c*o:s?c=s/o:c&&(s=c*o),p<m*o?m=p/o:p=m*o),d.minWidth=Math.min(s,p),d.minHeight=Math.min(c,m),d.maxWidth=p,d.maxHeight=m),t&&(l?(d.minLeft=Math.max(0,n.left),d.minTop=Math.max(0,n.top),d.maxLeft=Math.min(i.width,n.left+n.width)-d.width,d.maxTop=Math.min(i.height,n.top+n.height)-d.height):(d.minLeft=0,d.minTop=0,d.maxLeft=i.width-d.width,d.maxTop=i.height-d.height))},renderCropBox:function(){var e=this,t=e.options,a=e.containerData,r=e.cropBoxData;null==r&&(r=[]),(r.width>r.maxWidth||r.width<r.minWidth)&&(r.left=r.oldLeft),(r.height>r.maxHeight||r.height<r.minHeight)&&(r.top=r.oldTop),r.width=Math.min(Math.max(r.width,r.minWidth),r.maxWidth),r.height=Math.min(Math.max(r.height,r.minHeight),r.maxHeight),e.limitCropBox(!1,!0),r.oldLeft=r.left=Math.min(Math.max(r.left,r.minLeft),r.maxLeft),r.oldTop=r.top=Math.min(Math.max(r.top,r.minTop),r.maxTop),t.movable&&t.cropBoxMovable&&(null==a&&(a=[]),p.setData(e.face,"action",r.width===a.width&&r.height===a.height?"move":"all")),p.setStyle(e.cropBox,{width:r.width,height:r.height,left:r.left,top:r.top}),e.cropped&&e.limited&&e.limitCanvas(!0,!0),e.disabled||e.output()},output:function(){this.preview(),this.complete&&p.dispatchEvent(this.element,"crop",this.getData())}}},function(e,t){"use strict";function a(e){return R.call(e).slice(8,-1).toLowerCase()}function y(e){return"number"==typeof e&&!isNaN(e)}function o(e){return void 0===e}function n(e){return"object"===(void 0===e?"undefined":h(e))&&null!==e}function i(e){return"function"===a(e)}function d(e){return Array.isArray?Array.isArray(e):"array"===a(e)}function l(e){return"string"==typeof e&&(e=e.trim?e.trim():e.replace(C,"$1")),e}function s(t,a){if(t&&i(a)){var e=void 0;if(d(t)||y(t.length))for(var r=t.length,e=0;e<r&&!1!==a.call(t,t[e],e,t);e++);else n(t)&&Object.keys(t).forEach(function(e){a.call(t,t[e],e,t)})}return t}function c(e,t){var a;null==e&&(e=[]),y(e.length)?s(e,function(e){c(e,t)}):e.classList?e.classList.add(t):(a=l(e.className))?a.indexOf(t)<0&&(e.className=a+" "+t):e.className=t}function p(e,t){null==e&&(e=[]),y(e.length)?s(e,function(e){p(e,t)}):e.classList?e.classList.remove(t):0<=e.className.indexOf(t)&&(e.className=e.className.replace(t,""))}function r(e){return e.replace(g,"$1-$2").toLowerCase()}function m(t,e,a){var r=l(e).split(v);1<r.length?s(r,function(e){m(t,e,a)}):t.removeEventListener?t.removeEventListener(e,a,!1):t.detachEvent&&t.detachEvent("on"+e,a)}function b(e){return document.createElement(e)}function w(e,t){var a=Math.abs(e.degree)%180,r=(90<a?180-a:a)*Math.PI/180,o=Math.sin(r),i=Math.cos(r),n=e.width,d=e.height,l=e.aspectRatio,s=void 0,c=void 0,c=t?(s=n/(i+o/l))/l:(s=n*i+d*o,n*o+d*i);return{width:s,height:c}}function u(e,t,a){var r="",o=t;for(a+=t;o<a;o++)r+=O(e.getUint8(o));return r}Object.defineProperty(t,"__esModule",{value:!0});var h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};t.typeOf=a,t.isNumber=y,t.isUndefined=o,t.isObject=n,t.isPlainObject=function(e){if(!n(e))return!1;try{var t=e.constructor,a=t.prototype;return t&&a&&A.call(a,"isPrototypeOf")}catch(e){return!1}},t.isFunction=i,t.isArray=d,t.toArray=function(e,t){return t=0<=t?t:0,Array.from?Array.from(e).slice(t):L.call(e,t)},t.trim=l,t.each=s,t.extend=function a(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];var o=!0===t[0],i=o?t[1]:t[0];return 1<t.length&&(t.shift(),null==i&&(i=[]),t.forEach(function(t){n(t)&&Object.keys(t).forEach(function(e){o&&n(i[e])?a(!0,i[e],t[e]):i[e]=t[e]})})),i},t.proxy=function(r,o){for(var e=arguments.length,i=Array(2<e?e-2:0),t=2;t<e;t++)i[t-2]=arguments[t];return function(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return r.apply(o,i.concat(t))}},t.setStyle=function(e,t){null==e&&(e=[]);var a=e.style;null==a&&(a=[]),s(t,function(e,t){j.test(t)&&y(e)&&(e+="px"),a[t]=e})},t.hasClass=function(e,t){return e.classList?e.classList.contains(t):-1<e.className.indexOf(t)},t.addClass=c,t.removeClass=p,t.toggleClass=function t(e,a,r){y(e.length)?s(e,function(e){t(e,a,r)}):(r?c:p)(e,a)},t.hyphenate=r,t.getData=function(e,t){return n(e[t])?e[t]:e.dataset?e.dataset[t]:e.getAttribute("data-"+r(t))},t.setData=function(e,t,a){n(a)?e[t]=a:e.dataset?e.dataset[t]=a:e.setAttribute("data-"+r(t),a)},t.removeData=function(e,t){n(e[t])?delete e[t]:e.dataset?delete e.dataset[t]:e.removeAttribute("data-"+r(t))},t.removeListener=m,t.dispatchEvent=function(e,t,a){if(e.dispatchEvent){var r=void 0;return i(Event)&&i(CustomEvent)?r=o(a)?new Event(t,{bubbles:!0,cancelable:!0}):new CustomEvent(t,{detail:a,bubbles:!0,cancelable:!0}):o(a)?(r=document.createEvent("Event")).initEvent(t,!0,!0):(r=document.createEvent("CustomEvent")).initCustomEvent(t,!0,!0,a),e.dispatchEvent(r)}return!e.fireEvent||e.fireEvent("on"+t)},t.getEvent=function(e){var t,a,r,o=e||window.event;return o.target||(o.target=o.srcElement||document),!y(o.pageX)&&y(o.clientX)&&(a=(t=e.target.ownerDocument||document).documentElement,r=t.body,o.pageX=o.clientX+((a&&a.scrollLeft||r&&r.scrollLeft||0)-(a&&a.clientLeft||r&&r.clientLeft||0)),o.pageY=o.clientY+((a&&a.scrollTop||r&&r.scrollTop||0)-(a&&a.clientTop||r&&r.clientTop||0))),o},t.getOffset=function(e){var t=document.documentElement,a=e.getBoundingClientRect();return{left:a.left+((window.scrollX||t&&t.scrollLeft||0)-(t&&t.clientLeft||0)),top:a.top+((window.scrollY||t&&t.scrollTop||0)-(t&&t.clientTop||0))}},t.getTouchesCenter=function(e){var t=e.length,a=0,r=0;return t&&(s(e,function(e){a+=e.pageX,r+=e.pageY}),a/=t,r/=t),{pageX:a,pageY:r}},t.getByTag=function(e,t){return e.getElementsByTagName(t)},t.getByClass=function(e,t){return e.getElementsByClassName?e.getElementsByClassName(t):e.querySelectorAll("."+t)},t.createElement=b,t.appendChild=function(e,t){e.appendChild(t)},t.removeChild=function(e){e.parentNode&&e.parentNode.removeChild(e)},t.empty=function(e){for(;e.firstChild;)e.removeChild(e.firstChild)},t.isCrossOriginURL=function(e){var t=e.match(_);return t&&(t[1]!==location.protocol||t[2]!==location.hostname||t[3]!==location.port)},t.addTimestamp=function(e){var t="timestamp="+(new Date).getTime();return e+(-1===e.indexOf("?")?"?":"&")+t},t.getImageSize=function(e,t){var a;!e.naturalWidth||Q?((a=b("img")).onload=function(){t(this.width,this.height)},a.src=e.src):t(e.naturalWidth,e.naturalHeight)},t.getTransform=function(e){var t=[],a=e.rotate,r=e.scaleX,o=e.scaleY;return y(a)&&0!==a&&t.push("rotate("+a+"deg)"),y(r)&&1!==r&&t.push("scaleX("+r+")"),y(o)&&1!==o&&t.push("scaleY("+o+")"),t.length?t.join(" "):"none"},t.getRotatedSizes=w,t.getSourceCanvas=function(e,t){var a,r=b("canvas"),o=r.getContext("2d"),i=0,n=0,d=t.naturalWidth,l=t.naturalHeight,s=t.rotate,c=t.scaleX,p=t.scaleY,m=y(c)&&y(p)&&(1!==c||1!==p),u=y(s)&&0!==s,h=u||m,f=d*Math.abs(c),g=l*Math.abs(p),_=void 0,v=void 0;return m&&(_=f/2,v=g/2),u&&(_=(f=(a=w({width:f,height:g,degree:s})).width)/2,v=(g=a.height)/2),r.width=f,r.height=g,h&&(i=-d/2,n=-l/2,o.save(),o.translate(_,v)),u&&o.rotate(s*Math.PI/180),m&&o.scale(c,p),o.drawImage(e,Math.floor(i),Math.floor(n),Math.floor(d),Math.floor(l)),h&&o.restore(),r},t.getStringFromCharCode=u,t.getOrientation=function(e){var t,a,r,o=new DataView(e),i=o.byteLength,n=void 0,d=void 0,l=void 0,s=void 0,c=void 0,p=void 0;if(255===o.getUint8(0)&&216===o.getUint8(1))for(c=2;c<i;){if(255===o.getUint8(c)&&225===o.getUint8(c+1)){l=c;break}c++}if(l&&(t=l+10,"Exif"===u(o,l+4,4)&&((d=18761===(r=o.getUint16(t)))||19789===r)&&42===o.getUint16(t+2,d)&&8<=(a=o.getUint32(t+4,d))&&(s=t+a)),s)for(i=o.getUint16(s,d),p=0;p<i;p++)if(c=s+12*p+2,274===o.getUint16(c,d)){c+=8,n=o.getUint16(c,d),Q&&o.setUint16(c,1,d);break}return n},t.dataURLToArrayBuffer=function(e){for(var t=e.replace(f,""),a=atob(t),r=a.length,o=new ArrayBuffer(r),i=new Uint8Array(o),n=void 0,n=0;n<r;n++)i[n]=a.charCodeAt(n);return o},t.arrayBufferToDataURL=function(e){for(var t=new Uint8Array(e),a=t.length,r="",o=void 0,o=0;o<a;o++)r+=O(t[o]);return"data:image/jpeg;base64,"+btoa(r)};var f=/^data:([^;]+);base64,/,g=/([a-z\d])([A-Z])/g,_=/^(https?:)\/\/([^:\/\?#]+):?(\d*)/i,v=/\s+/,j=/^(width|height|left|top|marginLeft|marginTop)$/,C=/^\s+(.*)\s+$/,x=window.navigator,Q=x&&/(Macintosh|iPhone|iPod|iPad).*AppleWebKit/i.test(x.userAgent),M=Object.prototype,R=M.toString,A=M.hasOwnProperty,L=Array.prototype.slice,O=String.fromCharCode;t.addListener=function t(r,o,i,e){var a=l(o).split(v),n=i;1<a.length?s(a,function(e){t(r,e,i)}):(e&&(i=function(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return m(r,o,i),n.apply(r,t)}),r.addEventListener?r.addEventListener(o,i,!1):r.attachEvent&&r.attachEvent("on${type}",i))}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t}(a(4)),f="preview";t.default={initPreview:function(){var e,t=this,a=t.options.preview,r=h.createElement("img"),o=t.crossOrigin,i=o?t.crossOriginUrl:t.url;o&&(r.crossOrigin=o),r.src=i,h.appendChild(t.viewBox,r),t.image2=r,a&&(e=document.querySelectorAll(a),t.previews=e,h.each(e,function(e){var t=h.createElement("img");h.setData(e,f,{width:e.offsetWidth,height:e.offsetHeight,html:e.innerHTML}),o&&(t.crossOrigin=o),t.src=i,t.style.cssText='display:block;width:100%;height:auto;min-width:0!important;min-height:0!important;max-width:none!important;max-height:none!important;image-orientation:0deg!important;"',h.empty(e),h.appendChild(e,t)}))},resetPreview:function(){h.each(this.previews,function(e){var t=h.getData(e,f);h.setStyle(e,{width:t.width,height:t.height}),e.innerHTML=t.html,h.removeData(e,f)})},preview:function(){var e=this,t=e.imageData,a=e.canvasData;null==a&&(a=[]);var r=e.cropBoxData;null==r&&(r=[]);var d=r.width,l=r.height,s=t.width,c=t.height,p=r.left-a.left-t.left,m=r.top-a.top-t.top,o=h.getTransform(t),u={WebkitTransform:o,msTransform:o,transform:o};e.cropped&&!e.disabled&&(h.setStyle(e.image2,h.extend({width:s,height:c,marginLeft:-p,marginTop:-m},u)),h.each(e.previews,function(e){var t=h.getData(e,f),a=t.width,r=t.height,o=a,i=r,n=1;d&&(i=l*(n=a/d)),l&&r<i&&(o=d*(n=r/l),i=r),h.setStyle(e,{width:o,height:i}),h.setStyle(h.getByTag(e,"img")[0],h.extend({width:s*n,height:c*n,marginLeft:-p*n,marginTop:-m*n},u))}))}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t}(a(4)),i="mousedown touchstart pointerdown MSPointerDown",n="mousemove touchmove pointermove MSPointerMove",d="mouseup touchend touchcancel pointerup pointercancel MSPointerUp MSPointerCancel",l="wheel mousewheel DOMMouseScroll",s="dblclick",c="cropstart",p="cropmove",m="cropend";t.default={bind:function(){var e=this,t=e.options,a=e.element,r=e.cropper;o.isFunction(t.cropstart)&&o.addListener(a,c,t.cropstart),o.isFunction(t.cropmove)&&o.addListener(a,p,t.cropmove),o.isFunction(t.cropend)&&o.addListener(a,m,t.cropend),o.isFunction(t.crop)&&o.addListener(a,"crop",t.crop),o.isFunction(t.zoom)&&o.addListener(a,"zoom",t.zoom),o.addListener(r,i,e.onCropStart=o.proxy(e.cropStart,e)),t.zoomable&&t.zoomOnWheel&&o.addListener(r,l,e.onWheel=o.proxy(e.wheel,e)),t.toggleDragModeOnDblclick&&o.addListener(r,s,e.onDblclick=o.proxy(e.dblclick,e)),o.addListener(document,n,e.onCropMove=o.proxy(e.cropMove,e)),o.addListener(document,d,e.onCropEnd=o.proxy(e.cropEnd,e)),t.responsive&&o.addListener(window,"resize",e.onResize=o.proxy(e.resize,e))},unbind:function(){var e=this,t=e.options,a=e.element,r=e.cropper;o.isFunction(t.cropstart)&&o.removeListener(a,c,t.cropstart),o.isFunction(t.cropmove)&&o.removeListener(a,p,t.cropmove),o.isFunction(t.cropend)&&o.removeListener(a,m,t.cropend),o.isFunction(t.crop)&&o.removeListener(a,"crop",t.crop),o.isFunction(t.zoom)&&o.removeListener(a,"zoom",t.zoom),o.removeListener(r,i,e.onCropStart),t.zoomable&&t.zoomOnWheel&&o.removeListener(r,l,e.onWheel),t.toggleDragModeOnDblclick&&o.removeListener(r,s,e.onDblclick),o.removeListener(document,n,e.onCropMove),o.removeListener(document,d,e.onCropEnd),t.responsive&&o.removeListener(window,"resize",e.onResize)}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.REGEXP_ACTIONS=void 0;var l=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t}(a(4)),s=t.REGEXP_ACTIONS=/^(e|w|s|n|se|sw|ne|nw|all|crop|move|zoom)$/;t.default={resize:function(){var a,r,o,e=this,t=e.options.restore,i=e.container,n=e.containerData;!e.disabled&&n&&(a=i.offsetWidth/n.width,o=r=void 0,1==a&&i.offsetHeight===n.height||(t&&(r=e.getCanvasData(),o=e.getCropBoxData()),e.render(),t&&(e.setCanvasData(l.each(r,function(e,t){r[t]=e*a})),e.setCropBoxData(l.each(o,function(e,t){o[t]=e*a})))))},dblclick:function(){this.disabled||this.setDragMode(l.hasClass(this.dragBox,"cropper-crop")?"move":"crop")},wheel:function(e){var t=this,a=l.getEvent(e),r=Number(t.options.wheelZoomRatio)||.1,o=1;t.disabled||(a.preventDefault(),t.wheeling||(t.wheeling=!0,setTimeout(function(){t.wheeling=!1},50),a.deltaY?o=0<a.deltaY?1:-1:a.wheelDelta?o=-a.wheelDelta/120:a.detail&&(o=0<a.detail?1:-1),t.zoom(-o*r,a)))},cropStart:function(e){var t,a=this,r=a.options,o=l.getEvent(e),i=o.touches,n=void 0,d=void 0;if(!a.disabled){if(i){if(1<(t=i.length)){if(!r.zoomable||!r.zoomOnTouch||2!==t)return;n=i[1],a.startX2=n.pageX,a.startY2=n.pageY,d="zoom"}n=i[0]}if(d=d||l.getData(o.target,"action"),s.test(d)){if(!1===l.dispatchEvent(a.element,"cropstart",{originalEvent:o,action:d}))return;o.preventDefault(),a.action=d,a.cropping=!1,a.startX=n?n.pageX:o.pageX,a.startY=n?n.pageY:o.pageY,"crop"===d&&(a.cropping=!0,l.addClass(a.dragBox,"cropper-modal"))}}},cropMove:function(e){var t,a=this,r=a.options,o=l.getEvent(e),i=o.touches,n=a.action,d=void 0;if(!a.disabled){if(i){if(1<(t=i.length)){if(!r.zoomable||!r.zoomOnTouch||2!==t)return;d=i[1],a.endX2=d.pageX,a.endY2=d.pageY}d=i[0]}if(n){if(!1===l.dispatchEvent(a.element,"cropmove",{originalEvent:o,action:n}))return;o.preventDefault(),a.endX=d?d.pageX:o.pageX,a.endY=d?d.pageY:o.pageY,a.change(o.shiftKey,"zoom"===n?o:null)}}},cropEnd:function(e){var t=this,a=t.options,r=l.getEvent(e),o=t.action;t.disabled||o&&(r.preventDefault(),t.cropping&&(t.cropping=!1,l.toggleClass(t.dragBox,"cropper-modal",t.cropped&&a.modal)),t.action="",l.dispatchEvent(t.element,"cropend",{originalEvent:r,action:o}))}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var R=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t}(a(4)),A="se",L="sw",O="ne",k="nw";t.default={change:function(e,t){var a,r=this,o=r.options,i=r.containerData,n=r.canvasData,d=r.cropBoxData,l=o.aspectRatio,s=r.action,c=d.width,p=d.height,m=d.left,u=d.top,h=m+c,f=u+p,g=0,_=0,v=i.width,y=i.height,b=!0;!l&&e&&(l=c&&p?c/p:1),r.limited&&(g=d.minLeft,_=d.minTop,v=g+Math.min(i.width,n.left+n.width),y=_+Math.min(i.height,n.top+n.height));var w,j,C,x,Q,M={x:r.endX-r.startX,y:r.endY-r.startY};switch(l&&(M.X=M.y*l,M.Y=M.x/l),s){case"all":m+=M.x,u+=M.y;break;case"e":if(0<=M.x&&(v<=h||l&&(u<=_||y<=f))){b=!1;break}c+=M.x,l&&(p=c/l,u-=M.Y/2),c<0&&(s="w",c=0);break;case"n":if(M.y<=0&&(u<=_||l&&(m<=g||v<=h))){b=!1;break}p-=M.y,u+=M.y,l&&(c=p*l,m+=M.X/2),p<0&&(s="s",p=0);break;case"w":if(M.x<=0&&(m<=g||l&&(u<=_||y<=f))){b=!1;break}c-=M.x,m+=M.x,l&&(p=c/l,u+=M.Y/2),c<0&&(s="e",c=0);break;case"s":if(0<=M.y&&(y<=f||l&&(m<=g||v<=h))){b=!1;break}p+=M.y,l&&(c=p*l,m-=M.X/2),p<0&&(s="n",p=0);break;case O:if(l){if(M.y<=0&&(u<=_||v<=h)){b=!1;break}p-=M.y,u+=M.y,c=p*l}else!(0<=M.x)||h<v?c+=M.x:M.y<=0&&u<=_&&(b=!1),M.y<=0&&!(_<u)||(p-=M.y,u+=M.y);c<0&&p<0?(s=L,c=p=0):c<0?(s=k,c=0):p<0&&(s=A,p=0);break;case k:if(l){if(M.y<=0&&(u<=_||m<=g)){b=!1;break}p-=M.y,u+=M.y,c=p*l,m+=M.X}else!(M.x<=0)||g<m?(c-=M.x,m+=M.x):M.y<=0&&u<=_&&(b=!1),M.y<=0&&!(_<u)||(p-=M.y,u+=M.y);c<0&&p<0?(s=A,c=p=0):c<0?(s=O,c=0):p<0&&(s=L,p=0);break;case L:if(l){if(M.x<=0&&(m<=g||y<=f)){b=!1;break}c-=M.x,m+=M.x,p=c/l}else!(M.x<=0)||g<m?(c-=M.x,m+=M.x):0<=M.y&&y<=f&&(b=!1),0<=M.y&&!(f<y)||(p+=M.y);c<0&&p<0?(s=O,c=p=0):c<0?(s=A,c=0):p<0&&(s=k,p=0);break;case A:if(l){if(0<=M.x&&(v<=h||y<=f)){b=!1;break}p=(c+=M.x)/l}else!(0<=M.x)||h<v?c+=M.x:0<=M.y&&y<=f&&(b=!1),0<=M.y&&!(f<y)||(p+=M.y);c<0&&p<0?(s=k,c=p=0):c<0?(s=L,c=0):p<0&&(s=O,p=0);break;case"move":r.move(M.x,M.y),b=!1;break;case"zoom":r.zoom((w=Math.abs(r.startX-r.startX2),j=Math.abs(r.startY-r.startY2),C=Math.abs(r.endX-r.endX2),x=Math.abs(r.endY-r.endY2),Q=Math.sqrt(w*w+j*j),(Math.sqrt(C*C+x*x)-Q)/Q),t),r.startX2=r.endX2,r.startY2=r.endY2,b=!1;break;case"crop":if(!M.x||!M.y){b=!1;break}a=R.getOffset(r.cropper),m=r.startX-a.left,u=r.startY-a.top,c=d.minWidth,p=d.minHeight,0<M.x?s=0<M.y?A:O:M.x<0&&(m-=c,s=0<M.y?L:k),M.y<0&&(u-=p),r.cropped||(R.removeClass(r.cropBox,"cropper-hidden"),r.cropped=!0,r.limited&&r.limitCropBox(!0,!0))}b&&(d.width=c,d.height=p,d.left=m,d.top=u,r.action=s,r.renderCropBox()),r.startX=r.endX,r.startY=r.endY}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var R=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t}(a(4));t.default={crop:function(){var e=this;return e.ready&&!e.disabled&&(e.cropped||(e.cropped=!0,e.limitCropBox(!0,!0),e.options.modal&&R.addClass(e.dragBox,"cropper-modal"),R.removeClass(e.cropBox,"cropper-hidden")),e.setCropBoxData(e.initialCropBoxData)),e},reset:function(){var e=this;return e.ready&&!e.disabled&&(e.imageData=R.extend({},e.initialImageData),e.canvasData=R.extend({},e.initialCanvasData),e.cropBoxData=R.extend({},e.initialCropBoxData),e.renderCanvas(),e.cropped&&e.renderCropBox()),e},clear:function(){var e=this;return e.cropped&&!e.disabled&&(R.extend(e.cropBoxData,{left:0,top:0,width:0,height:0}),e.cropped=!1,e.renderCropBox(),e.limitCanvas(),e.renderCanvas(),R.removeClass(e.dragBox,"cropper-modal"),R.addClass(e.cropBox,"cropper-hidden")),e},replace:function(t,e){var a=this;return!a.disabled&&t&&(a.isImg&&(a.element.src=t),e?(a.url=t,a.image.src=t,a.ready&&(a.image2.src=t,R.each(a.previews,function(e){R.getByTag(e,"img")[0].src=t}))):(a.isImg&&(a.replaced=!0),a.options.data=null,a.load(t))),a},enable:function(){return this.ready&&(this.disabled=!1,R.removeClass(this.cropper,"cropper-disabled")),this},disable:function(){return this.ready&&(this.disabled=!0,R.addClass(this.cropper,"cropper-disabled")),this},destroy:function(){var e=this,t=e.element,a=e.image;return e.loaded?(e.isImg&&e.replaced&&(t.src=e.originalUrl),e.unbuild(),R.removeClass(t,"cropper-hidden")):e.isImg?R.removeListener(t,"load",e.start):a&&R.removeChild(a),R.removeData(t,"cropper"),e},move:function(e,t){var a=this.canvasData;return this.moveTo(R.isUndefined(e)?e:a.left+Number(e),R.isUndefined(t)?t:a.top+Number(t))},moveTo:function(e,t){var a=this,r=a.canvasData,o=!1;return R.isUndefined(t)&&(t=e),e=Number(e),t=Number(t),a.ready&&!a.disabled&&a.options.movable&&(R.isNumber(e)&&(r.left=e,o=!0),R.isNumber(t)&&(r.top=t,o=!0),o&&a.renderCanvas(!0)),a},zoom:function(e,t){var a=this.canvasData;return e=(e=Number(e))<0?1/(1-e):1+e,this.zoomTo(a.width*e/a.naturalWidth,t)},zoomTo:function(e,t){var a,r,o,i,n=this,d=n.options,l=n.canvasData,s=l.width,c=l.height,p=l.naturalWidth,m=l.naturalHeight;if(0<=(e=Number(e))&&n.ready&&!n.disabled&&d.zoomable){if(a=p*e,r=m*e,!1===R.dispatchEvent(n.element,"zoom",{originalEvent:t,oldRatio:s/p,ratio:a/p}))return n;t?(o=R.getOffset(n.cropper),i=t.touches?R.getTouchesCenter(t.touches):{pageX:t.pageX,pageY:t.pageY},l.left-=(a-s)*((i.pageX-o.left-l.left)/s),l.top-=(r-c)*((i.pageY-o.top-l.top)/c)):(l.left-=(a-s)/2,l.top-=(r-c)/2),l.width=a,l.height=r,n.renderCanvas(!0)}return n},rotate:function(e){return this.rotateTo((this.imageData.rotate||0)+Number(e))},rotateTo:function(e){var t=this;return e=Number(e),R.isNumber(e)&&t.ready&&!t.disabled&&t.options.rotatable&&(t.imageData.rotate=e%360,t.rotated=!0,t.renderCanvas(!0)),t},scale:function(e,t){var a=this,r=a.imageData,o=!1;return R.isUndefined(t)&&(t=e),e=Number(e),t=Number(t),a.ready&&!a.disabled&&a.options.scalable&&(R.isNumber(e)&&(r.scaleX=e,o=!0),R.isNumber(t)&&(r.scaleY=t,o=!0),o&&a.renderImage(!0)),a},scaleX:function(e){var t=this.imageData.scaleY;return this.scale(e,R.isNumber(t)?t:1)},scaleY:function(e){var t=this.imageData.scaleX;return this.scale(R.isNumber(t)?t:1,e)},getData:function(a){var r,e=this,t=e.options,o=e.imageData,i=e.canvasData,n=e.cropBoxData,d=void 0;return e.ready&&e.cropped?(d={x:n.left-i.left,y:n.top-i.top,width:n.width,height:n.height},r=o.width/o.naturalWidth,R.each(d,function(e,t){e/=r,d[t]=a?Math.round(e):e})):d={x:0,y:0,width:0,height:0},t.rotatable&&(d.rotate=o.rotate||0),t.scalable&&(d.scaleX=o.scaleX||1,d.scaleY=o.scaleY||1),d},setData:function(e){var t,a=this,r=a.options,o=a.imageData,i=a.canvasData,n={},d=void 0,l=void 0;return R.isFunction(e)&&(e=e.call(a.element)),a.ready&&!a.disabled&&R.isPlainObject(e)&&(r.rotatable&&R.isNumber(e.rotate)&&e.rotate!==o.rotate&&(o.rotate=e.rotate,a.rotated=d=!0),r.scalable&&(R.isNumber(e.scaleX)&&e.scaleX!==o.scaleX&&(o.scaleX=e.scaleX,l=!0),R.isNumber(e.scaleY)&&e.scaleY!==o.scaleY&&(o.scaleY=e.scaleY,l=!0)),d?a.renderCanvas():l&&a.renderImage(),t=o.width/o.naturalWidth,R.isNumber(e.x)&&(n.left=e.x*t+i.left),R.isNumber(e.y)&&(n.top=e.y*t+i.top),R.isNumber(e.width)&&(n.width=e.width*t),R.isNumber(e.height)&&(n.height=e.height*t),a.setCropBoxData(n)),a},getContainerData:function(){return this.ready?this.containerData:{}},getImageData:function(){return this.loaded?this.imageData:{}},getCanvasData:function(){var t=this.canvasData,a={};return this.ready&&R.each(["left","top","width","height","naturalWidth","naturalHeight"],function(e){a[e]=t[e]}),a},setCanvasData:function(e){var t=this,a=t.canvasData,r=a.aspectRatio;return R.isFunction(e)&&(e=e.call(t.element)),t.ready&&!t.disabled&&R.isPlainObject(e)&&(R.isNumber(e.left)&&(a.left=e.left),R.isNumber(e.top)&&(a.top=e.top),R.isNumber(e.width)?(a.width=e.width,a.height=e.width/r):R.isNumber(e.height)&&(a.height=e.height,a.width=e.height*r),t.renderCanvas(!0)),t},getCropBoxData:function(){var e=this.cropBoxData,t=void 0;return this.ready&&this.cropped&&(t={left:e.left,top:e.top,width:e.width,height:e.height}),t||{}},setCropBoxData:function(e){var t=this,a=t.cropBoxData,r=t.options.aspectRatio,o=void 0,i=void 0;return R.isFunction(e)&&(e=e.call(t.element)),t.ready&&t.cropped&&!t.disabled&&R.isPlainObject(e)&&(R.isNumber(e.left)&&(a.left=e.left),R.isNumber(e.top)&&(a.top=e.top),R.isNumber(e.width)&&(o=!0,a.width=e.width),R.isNumber(e.height)&&(i=!0,a.height=e.height),r&&(o?a.height=a.width/r:i&&(a.width=a.height*r)),t.renderCropBox()),t},getCroppedCanvas:function(e){var t=this;if(!t.ready||!window.HTMLCanvasElement)return null;if(!t.cropped)return R.getSourceCanvas(t.image,t.imageData);R.isPlainObject(e)||(e={});var a=t.getData(),r=a.width,o=a.height,i=r/o,n=void 0,d=void 0,l=void 0;R.isPlainObject(e)&&(n=e.width,d=e.height,n?(d=n/i,l=n/r):d&&(n=d*i,l=d/o));var s=Math.floor(n||r),c=Math.floor(d||o),p=R.createElement("canvas"),m=p.getContext("2d");p.width=s,p.height=c,e.fillColor&&(m.fillStyle=e.fillColor,m.fillRect(0,0,s,c));var u,h,f,g,_,v,y,b,w,j,C,x,Q,M=(u=R.getSourceCanvas(t.image,t.imageData),h=u.width,f=u.height,g=t.canvasData,_=[u],v=a.x+g.naturalWidth*(Math.abs(a.scaleX||1)-1)/2,y=a.y+g.naturalHeight*(Math.abs(a.scaleY||1)-1)/2,Q=x=C=j=w=b=void 0,v<=-r||h<v?v=b=j=x=0:v<=0?(j=-v,v=0,b=x=Math.min(h,r+v)):v<=h&&(j=0,b=x=Math.min(r,h-v)),b<=0||y<=-o||f<y?y=w=C=Q=0:y<=0?(C=-y,y=0,w=Q=Math.min(f,o+y)):y<=f&&(C=0,w=Q=Math.min(o,f-y)),_.push(Math.floor(v),Math.floor(y),Math.floor(b),Math.floor(w)),l&&(j*=l,C*=l,x*=l,Q*=l),0<x&&0<Q&&_.push(Math.floor(j),Math.floor(C),Math.floor(x),Math.floor(Q)),_);return m.drawImage.apply(m,function(e){if(Array.isArray(e)){for(var t=0,a=Array(e.length);t<e.length;t++)a[t]=e[t];return a}return Array.from(e)}(M)),p},setAspectRatio:function(e){var t=this,a=t.options;return t.disabled||R.isUndefined(e)||(a.aspectRatio=Math.max(0,e)||NaN,t.ready&&(t.initCropBox(),t.cropped&&t.renderCropBox())),t},setDragMode:function(e){var t,a,r=this,o=r.options,i=r.dragBox,n=r.face;return r.loaded&&!r.disabled&&(t="crop"===e,a=o.movable&&"move"===e,e=t||a?e:"none",R.setData(i,"action",e),R.toggleClass(i,"cropper-crop",t),R.toggleClass(i,"cropper-move",a),o.cropBoxMovable||(R.setData(n,"action",e),R.toggleClass(n,"cropper-crop",t),R.toggleClass(n,"cropper-move",a))),r}}}],a.c=o,a.p="",a(0);function a(e){if(o[e])return o[e].exports;var t=o[e]={exports:{},id:e,loaded:!1};return r[e].call(t.exports,t,t.exports,a),t.loaded=!0,t.exports}var r,o}),function(U){U.fn.bPopup=function(e,t){function a(){u.modal&&U('<div class="b-modal '+h+'"></div>').css({backgroundColor:u.modalColor,position:"fixed",top:0,right:0,bottom:0,left:0,opacity:0,zIndex:u.zIndex+k}).appendTo(u.appendTo).fadeTo(u.speed,u.opacity),p(),Q.data("bPopup",u).data("id",h).css({left:"slideIn"==u.transition||"slideBack"==u.transition?"slideBack"==u.transition?M.scrollLeft()+L:-1*(b+j):l(!(!u.follow[0]&&_||v)),position:u.positionStyle||"absolute",top:"slideDown"==u.transition||"slideUp"==u.transition?"slideUp"==u.transition?M.scrollTop()+A:y+-1*w:s(!(!u.follow[1]&&g||v)),"z-index":u.zIndex+k+1}).each(function(){u.appending&&U(this).appendTo(u.appendTo)}),n(!0)}function r(){return u.modal&&U(".b-modal."+Q.data("id")).fadeTo(u.speed,0,function(){U(this).remove()}),u.scrollBar||U("html").css("overflow","auto"),U(".b-modal."+h).off("click"),M.off("keydown."+h),R.off("."+h).data("bPopup",0<R.data("bPopup")-1?R.data("bPopup")-1:null),Q.undelegate(".bClose, ."+u.closeClass,"click."+h,r).data("bPopup",null),clearTimeout(x),n(),!1}function o(t){A=R.height(),L=R.width(),((f=m()).x||f.y)&&(clearTimeout(C),C=setTimeout(function(){p(),t=t||u.followSpeed;var e={};f.x&&(e.left=u.follow[0]?l(!0):"auto"),f.y&&(e.top=u.follow[1]?s(!0):"auto"),Q.dequeue().each(function(){v?U(this).css({left:b,top:y}):U(this).animate(e,t,u.followEasing)})},50))}function i(e){var t=e.width(),a=e.height(),r={};u.contentContainer.css({height:a,width:t}),a>=Q.height()&&(r.height=Q.height()),t>=Q.width()&&(r.width=Q.width()),w=Q.outerHeight(!0),j=Q.outerWidth(!0),p(),u.contentContainer.css({height:"auto",width:"auto"}),r.left=l(!(!u.follow[0]&&_||v)),r.top=s(!(!u.follow[1]&&g||v)),Q.animate(r,250,function(){e.show(),f=m()})}function n(t){function e(e){Q.css({display:"block",opacity:1}).animate(e,u.speed,u.easing,function(){d(t)})}switch(!t&&u.transitionClose||u.transition){case"slideIn":e({left:t?l(!(!u.follow[0]&&_||v)):M.scrollLeft()-(j||Q.outerWidth(!0))-200});break;case"slideBack":e({left:t?l(!(!u.follow[0]&&_||v)):M.scrollLeft()+L+200});break;case"slideDown":e({top:t?s(!(!u.follow[1]&&g||v)):M.scrollTop()-(w||Q.outerHeight(!0))-200});break;case"slideUp":e({top:t?s(!(!u.follow[1]&&g||v)):M.scrollTop()+A+200});break;default:Q.stop().fadeTo(u.speed,t?1:0,function(){d(t)})}}function d(e){e?(R.data("bPopup",k),Q.delegate(".bClose, ."+u.closeClass,"click."+h,r),u.modalClose&&U(".b-modal."+h).css("cursor","pointer").on("click",r),O||!u.follow[0]&&!u.follow[1]||R.on("scroll."+h,function(){var e;(f.x||f.y)&&(e={},f.x&&(e.left=u.follow[0]?l(!v):"auto"),f.y&&(e.top=u.follow[1]?s(!v):"auto"),Q.dequeue().animate(e,u.followSpeed,u.followEasing))}).on("resize."+h,function(){o()}),u.escClose&&M.on("keydown."+h,function(e){27==e.which&&r()}),c(t),u.autoClose&&(x=setTimeout(r,u.autoClose))):(Q.hide(),c(u.onClose),u.loadUrl&&(u.contentContainer.empty(),Q.css({height:"auto",width:"auto"})))}function l(e){return e?b+M.scrollLeft():b}function s(e){return e?y+M.scrollTop():y}function c(e,t){U.isFunction(e)&&e.call(Q,t)}function p(){y=g?u.position[1]:Math.max(0,(A-Q.outerHeight(!0))/2-u.amsl),b=_?u.position[0]:(L-Q.outerWidth(!0))/2,f=m()}function m(){return{x:L>Q.outerWidth(!0),y:A>Q.outerHeight(!0)}}U.isFunction(e)&&(t=e,e=null);var u=U.extend({},U.fn.bPopup.defaults,e);u.scrollBar||U("html").css("overflow","hidden");var h,f,g,_,v,y,b,w,j,C,x,Q=this,M=U(document),R=U(window),A=R.height(),L=R.width(),O=/OS 6(_\d)+/i.test(navigator.userAgent),k=0;return Q.close=function(){r()},Q.reposition=function(e){o(e)},Q.each(function(){U(this).data("bPopup")||(c(u.onOpen),k=(R.data("bPopup")||0)+1,h="__b-popup"+k+"__",g="auto"!==u.position[1],_="auto"!==u.position[0],v="fixed"===u.positionStyle,w=Q.outerHeight(!0),j=Q.outerWidth(!0),(u.loadUrl?function(){switch(u.contentContainer=U(u.contentContainer||Q),u.content){case"iframe":var e=U('<iframe class="b-iframe" '+u.iframeAttr+"></iframe>");e.appendTo(u.contentContainer),w=Q.outerHeight(!0),j=Q.outerWidth(!0),a(),e.attr("src",u.loadUrl),c(u.loadCallback);break;case"image":a(),U("<img />").load(function(){c(u.loadCallback),i(U(this))}).attr("src",u.loadUrl).hide().appendTo(u.contentContainer);break;default:a(),U('<div class="b-ajax-wrapper"></div>').load(u.loadUrl,u.loadData,function(e,t,a){c(u.loadCallback,t),i(U(this))}).hide().appendTo(u.contentContainer)}}:a)())})},U.fn.bPopup.defaults={amsl:50,appending:!0,appendTo:"body",autoClose:!1,closeClass:"b-close",content:"ajax",contentContainer:!1,easing:"swing",escClose:!0,follow:[!0,!0],followEasing:"swing",followSpeed:500,iframeAttr:'scrolling="no" frameborder="0"',loadCallback:!1,loadData:!1,loadUrl:!1,modal:!0,modalClose:!0,modalColor:"#000",onClose:!1,onOpen:!1,opacity:.7,position:["auto","auto"],positionStyle:"absolute",scrollBar:!0,speed:250,transition:"fadeIn",transitionClose:!1,zIndex:9997}}(jQuery),jQuery(document).ready(function(){function t(e){var a=e.target,t="";"null"!=(t=void 0===a.files?a&&a.value?[{name:a.value.replace(/^.+\\/,"")}]:[]:a.files)&&void 0!==t&&jQuery.each(t,function(e,t){!function(e,t){var d=jQuery(t),c=jQuery(t).attr("data-type"),p=jQuery(t).parents(".arm_template_container"),m=(d.attr("class"),d.attr("data-file_size"),new XMLHttpRequest),a=(e.type,e.name.lastIndexOf(".")),r=e.name.substring(a+1);r=r.toLowerCase();var o=d.attr("data-msg-invalid");null==o&&(o=invalidFileTypeError);if(-1===jQuery.inArray(r,["png","jpg","jpeg","bmp"]))return alert(o),d.val("");{var i,n,l,s,u,h;m.upload?(p.css("opacity","0.5"),i=function(e){for(var t=null!=e&&0!=e?e:5,a="",r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",o=0;o<t;o++)a+=r.charAt(Math.floor(Math.random()*r.length));return a}(6),n=e.name.lastIndexOf("."),l=e.name.substring(n+1),s=/.*(?=\.)/.exec(e.name),u=("armCover"+i+"_"+s).replace(/[^\w\s]/gi,"").replace(/ /g,"")+"."+l,h=new FormData,"cover"===c?h.append("action","arm_upload_cover"):h.append("action","arm_upload_profile"),"cover"!==c&&"profile"!==c||m.open("POST",__ARMAJAXURL,!0),m.setRequestHeader("X_FILENAME",u),m.setRequestHeader("X-FILENAME",u),h.append("armfileselect",e),m.send(h),m.onreadystatechange=function(){if(4!=m.readyState||200!=m.status)return 200!=m.status&&(p.css("opacity","1"),alert(fileUploadError),d.val("")),!1;var t,e,l,a,r,o,i,s,n=m.responseText;p.css("opacity","1"),"cover"===c?770<jQuery(window).width()?(-1==n.indexOf("http://")&&-1==n.indexOf("https://")||(n="//"+n.split("://")[1]),jQuery("#arm_crop_cover_div").find("img").attr("src",""),jQuery("#arm_crop_cover_div").find("img").attr("src",n),t=0,e=jQuery("#arm_crop_cover_image"),l=new Cropper(e,{viewMode:4,aspectRatio:2.86875,zoomable:!0,rotatable:!0,dashed:!1,dragMode:"move",cropBoxResizable:!1,background:!1,zoomOnTouch:!1,crop:function(e){jQuery("#arm_crop_cover_image").attr("data-coord",Math.round(e.detail.x)+","+Math.round(e.detail.y)+","+Math.round(e.detail.width)+","+Math.round(e.detail.height)),0==t&&(jQuery(".arm_clear_cover_button.arm_img_cover_setting").trigger("click"),jQuery("#arm_crop_cover_image").attr("data-coord","0,0,0,0"),t=1)}}),jQuery(".arm_img_cover_setting").on("click",function(e){var t,a,r,o,i=e||window.event,n=i.target||i.srcElement,d=4;if(l){for(;n!==this&&!n.getAttribute("data-method");)n=n.parentNode;if(o={method:n.getAttribute("data-method"),target:n.getAttribute("data-target"),option:n.getAttribute("data-option")||void 0,secondOption:n.getAttribute("data-second-option")||void 0},t=l.cropped,o.method){if(void 0!==o.target&&(r=document.querySelector(o.target),!n.hasAttribute("data-option")&&o.target&&r))try{o.option=JSON.parse(r.value)}catch(i){console.log(i.message)}switch(o.method){case"reset":case"rotate":t&&0<d&&l.clear();break;case"getCroppedCanvas":try{o.option=JSON.parse(o.option)}catch(i){console.log(i.message)}"image/jpeg"===uploadedImageType&&(o.option||(o.option={}),o.option.fillColor="#fff")}switch(a=l[o.method](o.option,o.secondOption),o.method){case"rotate":t&&0<d&&l.crop();break;case"scaleX":case"scaleY":n.setAttribute("data-option",-o.option);break;case"getCroppedCanvas":a&&(jQuery("#getCroppedCanvasModal").modal().find(".modal-body").html(a),download.disabled||(download.download=uploadedImageName,download.href=a.toDataURL(uploadedImageType)));break;case"destroy":l=null,uploadedImageURL&&(URL.revokeObjectURL(uploadedImageURL),uploadedImageURL="",image.src=originalImageURL)}if("object"==typeof a&&a!==l&&r)try{r.value=JSON.stringify(a)}catch(i){console.log(i.message)}}}}),document.getElementsByClassName("arm_crop_cover_button")[0].onclick=function(){var e=jQuery("#arm_crop_cover_image").attr("data-coord"),t=jQuery("#arm_crop_cover_image").attr("src"),a=jQuery("#arm_crop_cover_image").attr("data-rotate");jQuery.ajax({type:"POST",url:__ARMAJAXURL,data:"action=arm_crop_iamge&type=cover&src="+t+"&cord="+e+"&rotate="+a,success:function(e){jQuery("<img />").attr("src",e+"?"+Math.floor(100*Math.random()+1)),jQuery(".arm_profile_picture_block").css("background-image","url("+e+"?"+Math.floor(100*Math.random())+")"),jQuery("#arm_crop_cover_div_wrapper").bPopup().close(),jQuery("#armRemoveCover").show();var t=n.lastIndexOf("/")+1,a=n.substr(t);jQuery("#armRemoveCover").attr("data-cover",a),jQuery("#arm_crop_cover_image").attr("src",""),l.destroy(),jQuery("#arm_crop_cover_image").attr("data-rotate",0),arm_avtr_rotation=0}})},jQuery("#arm_crop_cover_div_wrapper").bPopup({opacity:.5,closeClass:"arm_popup_close_btn",follow:[!0,!0],escClose:!1,modalClose:!1,onClose:function(){l.destroy()}})):(jQuery("#arm_crop_cover_div").find("img").remove(),jQuery(".arm_profile_picture_block").css("background-image",""),-1==n.indexOf("http://")&&-1==n.indexOf("https://")||(n="//"+n.split("://")[1]),jQuery.ajax({type:"POST",url:__ARMAJAXURL,data:"action=arm_update_user_meta&type="+c+"&image_url="+n,dataType:"json",success:function(){}}),jQuery("<img />").attr("src",n+"?"+Math.floor(100*Math.random()+1)),jQuery(".arm_profile_picture_block").css("background-image","url("+n+"?"+Math.floor(100*Math.random())+")"),jQuery("#armRemoveCover").show(),a=n.lastIndexOf("/")+1,r=n.substr(a),jQuery("#armRemoveCover").attr("data-cover",r)):"profile"===c&&(-1==n.indexOf("http://")&&-1==n.indexOf("https://")||(n="//"+n.split("://")[1]),jQuery("#arm_crop_div").find("img").attr("src",""),jQuery("#arm_crop_div").find("img").attr("src",n),o=0,i=jQuery("#arm_crop_image"),s=new Cropper(i,{viewMode:4,aspectRatio:1,dragCrop:!1,zoomable:!0,rotatable:!0,dashed:!1,dragMode:"move",cropBoxResizable:!1,zoomOnTouch:!1,crop:function(e){jQuery("#arm_crop_image").attr("data-coord",Math.round(e.detail.x)+","+Math.round(e.detail.y)+","+Math.round(e.detail.width)+","+Math.round(e.detail.height)),0==o&&(jQuery(".arm_clear_button.arm_img_setting").trigger("click"),jQuery("#arm_crop_image").attr("data-coord","0,0,0,0"),o=1)},background:!1}),jQuery(".arm_img_setting").on("click",function(e){var t,a,r,o,i=e||window.event,n=i.target||i.srcElement,d=4;if(s){for(;n!==this&&!n.getAttribute("data-method");)n=n.parentNode;if(o={method:n.getAttribute("data-method"),target:n.getAttribute("data-target"),option:n.getAttribute("data-option")||void 0,secondOption:n.getAttribute("data-second-option")||void 0},t=s.cropped,o.method){if(void 0!==o.target&&(r=document.querySelector(o.target),!n.hasAttribute("data-option")&&o.target&&r))try{o.option=JSON.parse(r.value)}catch(i){console.log(i.message)}switch(o.method){case"reset":case"rotate":t&&0<d&&s.clear();break;case"getCroppedCanvas":try{o.option=JSON.parse(o.option)}catch(i){console.log(i.message)}"image/jpeg"===uploadedImageType&&(o.option||(o.option={}),o.option.fillColor="#fff")}switch(a=s[o.method](o.option,o.secondOption),o.method){case"rotate":t&&0<d&&s.crop();break;case"scaleX":case"scaleY":n.setAttribute("data-option",-o.option);break;case"getCroppedCanvas":a&&(jQuery("#getCroppedCanvasModal").modal().find(".modal-body").html(a),download.disabled||(download.download=uploadedImageName,download.href=a.toDataURL(uploadedImageType)));break;case"destroy":s=null,uploadedImageURL&&(URL.revokeObjectURL(uploadedImageURL),uploadedImageURL="",image.src=originalImageURL)}if("object"==typeof a&&a!==s&&r)try{r.value=JSON.stringify(a)}catch(i){console.log(i.message)}}}}),document.getElementsByClassName("arm_crop_button")[0].onclick=function(){var e=jQuery("#arm_crop_image").attr("data-coord"),t=jQuery("#arm_crop_image").attr("src"),a=jQuery("#arm_crop_image").attr("data-rotate");jQuery.ajax({type:"POST",url:__ARMAJAXURL,data:"action=arm_crop_iamge&type=profile&src="+t+"&cord="+e+"&rotate="+a,success:function(e){jQuery(".arm_user_avatar").find("img").remove();var t=jQuery("<img />").attr("src",e+"?"+Math.floor(100*Math.random()+1));jQuery(".arm_user_avatar").append(t),jQuery("#armRemoveProfilePic").parent().show(),jQuery(".arm_user_avatar").find("#armRemoveProfilePic").show();var a=e.split("/"),r=a[Object.keys(a).length-1];jQuery(".arm_user_avatar").find("#armRemoveProfilePic").attr("data-cover",r),jQuery("#armRemoveProfilePic").parent().removeClass("arm_no_profile"),jQuery("#arm_crop_div_wrapper").bPopup().close(),jQuery("#arm_crop_image").attr("src",""),s.destroy(),jQuery("#arm_crop_image").attr("data-rotate",0),arm_avtr_rotation=0}})},jQuery("#arm_crop_div_wrapper").bPopup({opacity:.5,closeClass:"arm_popup_close_btn",follow:[!1,!1],escClose:!1,modalClose:!1,onClose:function(){s.destroy()}}))}):(alert(fileUploadError),d.val(""))}}(t,a)})}jQuery(".armCoverUpload").each(function(){var e=jQuery(this).attr("id");""!=e&&null!=e&&document.getElementById(e).addEventListener("change",t,!1)}),jQuery(".armRemoveCover:not(#armRemoveProfilePic)").click(function(){jQuery(".arm_delete_cover_popup").addClass("armopen").slideDown()})}),jQuery(document).on("click","#armRemoveProfilePic",function(){jQuery(".arm_delete_profile_popup").addClass("armopen").slideDown()}),jQuery(document).on("click",".armIEFileUpload_profile",function(){var s=jQuery(this),c=s.attr("data-iframe"),e=jQuery("#"+c+"_iframe");e.contents().find("#armfileselect").click();var t=e.contents().find("#armfileselect").val(),p=s.attr("data-type");if(""!=t&&void 0!==t){var m=s.parents(".armFileUploadWrapper"),u=(m.find(".armFileBtn"),m.find(".armFileUploadContainer"),m.find(".armFileRemoveContainer"),m.find(".armFileUploadProgressBar"),m.find(".armFileUploadProgressInfo"),s.attr("data-file_size")),a=1024*u*1024;null==s.attr("data-msg-invalid")&&invalidFileTypeError;var r,h,f,o=t.replace(/C:\\fakepath\\/i,""),i=RandomString(6),n=o.lastIndexOf("."),d=o.substring(n+1),l=/.*(?=\.)/.exec(o),g=s.attr("data-upload-url"),_=("armFile"+i+"_"+l).replace(/[^\w\s]/gi,"").replace(/ /g,"")+"."+d,v=d.toLowerCase(),y=s.attr("accept");if(null!=y&&(r=y.replace(/\./g,"").split(","),-1===jQuery.inArray(v,r)))return s.val(_),s.attr("value",_),s.trigger("change"),!1;-1===jQuery.inArray(v,["php","php3","php4","php5","pl","py","jsp","asp","exe","cgi","gif"])&&("cover"===p?(e.contents().find("form").attr("action",__ARMAJAXURL+"?action=arm_upload_cover&fname="+_+"&allow_size="+a),e.contents().find("form").submit(),m.find(".armUploadedFileName").val(_),h=g+"/"+_,f=setInterval(function(){var t,e,l,a,r,o=jQuery("#"+c+"_iframe").contents().find(".uploaded").length;s.val(_),s.attr("value",_),0<o&&(clearInterval(f),jQuery("#"+c+"_iframe").contents().find(".uploaded").html(),m.find(".armUploadedFileName").val(_),jQuery("#"+c+"_iframe_div").html(" ").append('<iframe id="'+c+'_iframe" src="'+__ARMVIEWURL+'/iframeupload.php"></iframe>'),s.trigger("change"),770<jQuery(window).width()?(-1==h.indexOf("http://")&&-1==h.indexOf("https://")||(h="//"+h.split("://")[1]),jQuery("#arm_crop_cover_div").find("img").attr("src",h),jQuery("#arm_crop_cover_div_wrapper").bPopup({opacity:.5,closeClass:"arm_popup_close_btn",follow:[!0,!0],escClose:!1,modalClose:!1,onClose:function(){l.destroy()}}),t=0,e=jQuery("#arm_crop_cover_image"),l=new Cropper(e,{viewMode:4,aspectRatio:2.86875,zoomable:!0,rotatable:!0,dashed:!1,dragMode:"move",cropBoxResizable:!1,background:!1,zoomOnTouch:!1,crop:function(e){jQuery("#arm_crop_cover_image").attr("data-coord",Math.round(e.detail.x)+","+Math.round(e.detail.y)+","+Math.round(e.detail.width)+","+Math.round(e.detail.height)),0==t&&(jQuery(".arm_clear_cover_button.arm_img_cover_setting").trigger("click"),jQuery("#arm_crop_cover_image").attr("data-coord","0,0,0,0"),t=1)}}),jQuery(".arm_img_cover_setting").on("click",function(e){var t,a,r,o,i=e||window.event,n=i.target||i.srcElement,d=4;if(l){for(;n!==this&&!n.getAttribute("data-method");)n=n.parentNode;if(o={method:n.getAttribute("data-method"),target:n.getAttribute("data-target"),option:n.getAttribute("data-option")||void 0,secondOption:n.getAttribute("data-second-option")||void 0},t=l.cropped,o.method){if(void 0!==o.target&&(r=document.querySelector(o.target),!n.hasAttribute("data-option")&&o.target&&r))try{o.option=JSON.parse(r.value)}catch(i){console.log(i.message)}switch(o.method){case"reset":case"rotate":t&&0<d&&l.clear();break;case"getCroppedCanvas":try{o.option=JSON.parse(o.option)}catch(i){console.log(i.message)}"image/jpeg"===uploadedImageType&&(o.option||(o.option={}),o.option.fillColor="#fff")}switch(a=l[o.method](o.option,o.secondOption),o.method){case"rotate":t&&0<d&&l.crop();break;case"scaleX":case"scaleY":n.setAttribute("data-option",-o.option);break;case"getCroppedCanvas":a&&(jQuery("#getCroppedCanvasModal").modal().find(".modal-body").html(a),download.disabled||(download.download=uploadedImageName,download.href=a.toDataURL(uploadedImageType)));break;case"destroy":l=null,uploadedImageURL&&(URL.revokeObjectURL(uploadedImageURL),uploadedImageURL="",image.src=originalImageURL)}if("object"==typeof a&&a!==l&&r)try{r.value=JSON.stringify(a)}catch(i){console.log(i.message)}}}}),document.getElementsByClassName("arm_crop_cover_button")[0].onclick=function(){var e=jQuery("#arm_crop_cover_image").attr("data-coord"),t=jQuery("#arm_crop_cover_image").attr("src"),a=jQuery("#arm_crop_cover_image").attr("data-rotate");jQuery.ajax({type:"POST",url:__ARMAJAXURL,data:"action=arm_crop_iamge&type=cover&src="+t+"&cord="+e+"&rotate="+a,success:function(e){jQuery("<img />").attr("src",e+"?"+Math.floor(100*Math.random()+1)).on("load",function(){jQuery(".arm_profile_picture_block").css("background-image","url("+e+"?"+Math.floor(100*Math.random())+")")}),jQuery("#arm_crop_cover_div_wrapper").bPopup().close(),jQuery("#armRemoveCover").show(),jQuery("#arm_crop_cover_image").attr("src",""),l.destroy(),jQuery("#arm_crop_cover_image").attr("data-rotate",0),arm_avtr_rotation=0}})}):(jQuery("#arm_crop_cover_div").find("img").remove(),jQuery(".arm_profile_picture_block").css("background-image",""),-1==h.indexOf("http://")&&-1==h.indexOf("https://")||(h="//"+h.split("://")[1]),jQuery.ajax({type:"POST",url:__ARMAJAXURL,data:"action=arm_update_user_meta&type="+p+"&image_url="+h,dataType:"json",success:function(){}}),jQuery("<img />").attr("src",h+"?"+Math.floor(100*Math.random()+1)).on("load",function(){jQuery(".arm_profile_picture_block").css("background-image","url("+h+"?"+Math.floor(100*Math.random())+")")}),jQuery("#armRemoveCover").show(),a=h.lastIndexOf("/")+1,r=h.substr(a),jQuery("#armRemoveCover").attr("data-cover",r)));var i,n=jQuery("#"+c+"_iframe").contents().find(".error_upload").length,d=jQuery("#"+c+"_iframe").contents().find(".error_upload_size").length;(0<n||0<d)&&(clearInterval(f),0<n&&alert(fileUploadError),0<d)&&(i=(i=(i=fileSizeError).replace("{SIZE}",u+"MB")).replace("{size}",u+"MB"),alert(i))},500)):"profile"===p&&(e.contents().find("form").attr("action",__ARMAJAXURL+"?action=arm_upload_profile&fname="+_+"&allow_size="+a),e.contents().find("form").submit(),m.find(".armUploadedFileName").val(_),h=g+"/"+_,f=setInterval(function(){var t,e,l,a=jQuery("#"+c+"_iframe").contents().find(".uploaded").length;s.val(_),s.attr("value",_),0<a&&(clearInterval(f),jQuery("#"+c+"_iframe").contents().find(".uploaded").html(),m.find(".armUploadedFileName").val(_),jQuery("#"+c+"_iframe_div").html(" ").append('<iframe id="'+c+'_iframe" src="'+__ARMVIEWURL+'/iframeupload.php"></iframe>'),s.trigger("change"),770<jQuery(window).width()?(-1==h.indexOf("http://")&&-1==h.indexOf("https://")||(h="//"+h.split("://")[1]),jQuery("#arm_crop_div").find("img").attr("src",h),t=0,e=jQuery("#arm_crop_image"),l=new Cropper(e,{viewMode:4,aspectRatio:1,dragCrop:!1,zoomable:!0,rotatable:!0,dashed:!1,dragMode:"move",cropBoxResizable:!1,zoomOnTouch:!1,crop:function(e){jQuery("#arm_crop_image").attr("data-coord",Math.round(e.detail.x)+","+Math.round(e.detail.y)+","+Math.round(e.detail.width)+","+Math.round(e.detail.height)),0==t&&(jQuery(".arm_clear_button.arm_img_setting").trigger("click"),jQuery("#arm_crop_image").attr("data-coord","0,0,0,0"),t=1)},background:!1}),jQuery(".arm_img_setting").on("click",function(e){var t,a,r,o,i=e||window.event,n=i.target||i.srcElement,d=4;if(l){for(;n!==this&&!n.getAttribute("data-method");)n=n.parentNode;if(o={method:n.getAttribute("data-method"),target:n.getAttribute("data-target"),option:n.getAttribute("data-option")||void 0,secondOption:n.getAttribute("data-second-option")||void 0},t=l.cropped,o.method){if(void 0!==o.target&&(r=document.querySelector(o.target),!n.hasAttribute("data-option")&&o.target&&r))try{o.option=JSON.parse(r.value)}catch(i){console.log(i.message)}switch(o.method){case"reset":case"rotate":t&&0<d&&l.clear();break;case"getCroppedCanvas":try{o.option=JSON.parse(o.option)}catch(i){console.log(i.message)}"image/jpeg"===uploadedImageType&&(o.option||(o.option={}),o.option.fillColor="#fff")}switch(a=l[o.method](o.option,o.secondOption),o.method){case"rotate":t&&0<d&&l.crop();break;case"scaleX":case"scaleY":n.setAttribute("data-option",-o.option);break;case"getCroppedCanvas":a&&(jQuery("#getCroppedCanvasModal").modal().find(".modal-body").html(a),download.disabled||(download.download=uploadedImageName,download.href=a.toDataURL(uploadedImageType)));break;case"destroy":l=null,uploadedImageURL&&(URL.revokeObjectURL(uploadedImageURL),uploadedImageURL="",image.src=originalImageURL)}if("object"==typeof a&&a!==l&&r)try{r.value=JSON.stringify(a)}catch(i){console.log(i.message)}}}}),document.getElementsByClassName("arm_crop_button")[0].onclick=function(){var e=jQuery("#arm_crop_image").attr("data-coord"),t=jQuery("#arm_crop_image").attr("src"),a=jQuery("#arm_crop_image").attr("data-rotate");jQuery.ajax({type:"POST",url:__ARMAJAXURL,data:"action=arm_crop_iamge&type=profile&src="+t+"&cord="+e+"&rotate="+a,success:function(e){jQuery(".arm_user_avatar").find("img").remove();var t=jQuery("<img />").attr("src",e+"?"+Math.floor(100*Math.random()+1));jQuery(".arm_user_avatar").append(t),jQuery("#armRemoveProfilePic").parent().show(),jQuery(".arm_user_avatar").find("#armRemoveProfilePic").show();var a=e.split("/"),r=a[Object.keys(a).length-1];jQuery(".arm_user_avatar").find("#armRemoveProfilePic").attr("data-cover",r),jQuery("#armRemoveProfilePic").parent().removeClass("arm_no_profile"),jQuery("#arm_crop_div_wrapper").bPopup().close(),jQuery("#arm_crop_image").attr("src",""),l.destroy(),jQuery("#arm_crop_image").attr("data-rotate",0),arm_avtr_rotation=0}})},jQuery("#arm_crop_div_wrapper").bPopup({opacity:.5,closeClass:"arm_popup_close_btn",follow:[!1,!1],escClose:!1,modalClose:!1,onClose:function(){l.destroy()}})):(jQuery(".arm_user_avatar").find("img").remove(),-1==h.indexOf("http://")&&-1==h.indexOf("https://")||(h="//"+h.split("://")[1]),jQuery.ajax({type:"POST",url:__ARMAJAXURL,data:"action=arm_update_user_meta&type="+p+"&image_url="+h,dataType:"json",success:function(){}}),jQuery("<img />").attr("src",h+"?"+Math.floor(100*Math.random()+1)).on("load",function(){jQuery(".arm_user_avatar").append(jQuery(this)),jQuery("#armRemoveProfilePic").parent().show(),jQuery(".arm_user_avatar").find("#armRemoveProfilePic").show();var e=(void 0).split("/"),t=e[Object.keys(e).length-1];jQuery(".arm_user_avatar").find("#armRemoveProfilePic").attr("data-cover",t),jQuery("#armRemoveProfilePic").parent().removeClass("arm_no_profile")})));var r,o=jQuery("#"+c+"_iframe").contents().find(".error_upload").length,i=jQuery("#"+c+"_iframe").contents().find(".error_upload_size").length;(0<o||0<i)&&(clearInterval(f),0<o&&alert(fileUploadError),0<i)&&(r=(r=(r=fileSizeError).replace("{SIZE}",u+"MB")).replace("{size}",u+"MB"),alert(r))})))}});